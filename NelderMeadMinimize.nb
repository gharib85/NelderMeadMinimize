(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    131453,       2626]
NotebookOptionsPosition[    127944,       2526]
NotebookOutlinePosition[    128310,       2542]
CellTagsIndexPosition[    128267,       2539]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["See ",
  FontSize->16],
 Cell[BoxData[
  FormBox[
   ButtonBox[
    RowBox[{
     RowBox[{"tutorial", "/", "ConstrainedOptimizationGlobalNumerical"}], " ",
      "#323477034"}],
    BaseStyle->"Link",
    ButtonData->
     "paclet:tutorial/ConstrainedOptimizationGlobalNumerical#323477034"], 
   TraditionalForm]],
  FontSize->16],
 StyleBox[" for details about the Nelder-Mead method as implemented in ",
  FontSize->16],
 StyleBox["NMinimize", "Input",
  FontSize->16],
 StyleBox[".",
  FontSize->16]
}], "Text",
 CellChangeTimes->{{3.544311059796875*^9, 3.5443110885625*^9}, {
  3.54431112190625*^9, 3.544311184828125*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<NelderMeadMinimize`\>\"", "]"}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.54446333725*^9, 3.544463350421875*^9}, 
   3.5446534856875*^9, {3.544672119390625*^9, 3.544672119671875*^9}, {
   3.574253233015625*^9, 3.57425323446875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "NelderMeadMinimize", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"NelderMeadMinimize", ",", "HoldAll"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "NelderMeadMinimize", "]"}], "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<InitialPoints\>\"", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"\"\<RandomSeed\>\"", "\[Rule]", 
       RowBox[{"Sequence", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Method", "\[Rule]", "\"\<MKL\>\""}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<ConvergenceTolerance\>\"", "\[Rule]", "$MachineEpsilon"}], 
      ",", 
      RowBox[{"\"\<HistoryLength\>\"", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"MaxIterations", "\[Rule]", "Infinity"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<ReflectRatio\>\"", "\[Rule]", "1"}], ",", 
      RowBox[{"\"\<ExpandRatio\>\"", "\[Rule]", "2"}], ",", 
      RowBox[{"\"\<ContractRatio\>\"", "\[Rule]", 
       RowBox[{"1", "/", "2"}]}], ",", 
      RowBox[{"\"\<ShrinkRatio\>\"", "\[Rule]", 
       RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Diagnostics\>\"", "\[Rule]", "False"}], ",", 
      RowBox[{"CompilationTarget", "\[RuleDelayed]", "$CompilationTarget"}]}],
      "\[IndentingNewLine]", "}"}], "//", "Sort"}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.544304487671875*^9, 3.54430451771875*^9}, {
   3.54430502671875*^9, 3.54430503525*^9}, 3.544305256375*^9, {
   3.5443054703125*^9, 3.544305475265625*^9}, {3.544309054109375*^9, 
   3.544309085390625*^9}, {3.544310068921875*^9, 3.544310189859375*^9}, {
   3.544310237375*^9, 3.54431028521875*^9}, {3.5443103804375*^9, 
   3.5443103875*^9}, {3.544310875859375*^9, 3.5443108785625*^9}, {
   3.544311246265625*^9, 3.544311268421875*^9}, 3.54431831196875*^9, {
   3.5443561263348637`*^9, 3.544356142912989*^9}, {3.544356588350489*^9, 
   3.544356589819239*^9}, {3.544357835131739*^9, 3.5443578376473637`*^9}, {
   3.5443580423973637`*^9, 3.544358053850489*^9}, {3.5443761356473637`*^9, 
   3.544376144162989*^9}, {3.5443868626473637`*^9, 3.544386885944239*^9}, {
   3.544387015600489*^9, 3.5443870348348637`*^9}, {3.5443870832098637`*^9, 
   3.5443871246786137`*^9}, {3.5444001674598637`*^9, 3.544400181725489*^9}, {
   3.5444002357723637`*^9, 3.544400236725489*^9}, {3.544401063662989*^9, 
   3.5444010670536137`*^9}, {3.544401112194239*^9, 3.5444011194598637`*^9}, 
   3.5444013035848637`*^9, {3.544463362890625*^9, 3.54446341*^9}, {
   3.54447548496875*^9, 3.544475485265625*^9}, {3.5444755474375*^9, 
   3.54447554853125*^9}, {3.544477351515625*^9, 3.544477355421875*^9}, {
   3.544477457453125*^9, 3.54447746190625*^9}, 3.5446534856875*^9, {
   3.573089344859375*^9, 3.57308935246875*^9}, {3.573227185024333*^9, 
   3.573227188680583*^9}, {3.573227234211833*^9, 3.573227236055583*^9}, {
   3.57377577890625*^9, 3.573775779546875*^9}, 3.573775821328125*^9, {
   3.57377659103125*^9, 3.57377659659375*^9}, {3.57424590953125*^9, 
   3.574245910953125*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "ClearAll", "[", "NelderMeadMinimize`Dump`CompiledNelderMead", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Options", "[", "NelderMeadMinimize`Dump`CompiledNelderMead", "]"}], "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<HistoryLength\>\"", "\[Rule]", "Automatic"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<ReflectRatio\>\"", "\[Rule]", "1"}], ",", 
      RowBox[{"\"\<ExpandRatio\>\"", "\[Rule]", "2"}], ",", 
      RowBox[{"\"\<ContractRatio\>\"", "\[Rule]", 
       RowBox[{"1", "/", "2"}]}], ",", 
      RowBox[{"\"\<ShrinkRatio\>\"", "\[Rule]", 
       RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<ReturnValues\>\"", "\[Rule]", 
       "\"\<AugmentedOptimizedParameters\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<Diagnostics\>\"", "\[Rule]", "False"}], ",", 
      RowBox[{"CompilationTarget", "\[RuleDelayed]", "$CompilationTarget"}]}],
      "\[IndentingNewLine]", "}"}], "//", "Sort"}]}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.544464299609375*^9, 3.544464320796875*^9}, {
   3.544465547828125*^9, 3.544465548609375*^9}, {3.544475664484375*^9, 
   3.544475664875*^9}, {3.544477266546875*^9, 3.54447727684375*^9}, {
   3.544477314*^9, 3.544477314421875*^9}, 3.54447801221875*^9, 
   3.5446534856875*^9, {3.5452464751875*^9, 3.5452464825625*^9}, {
   3.545250099765625*^9, 3.5452501214375*^9}, {3.54525147884375*^9, 
   3.54525148959375*^9}, 3.54526949971875*^9, 3.545319189703125*^9, 
   3.573089609875*^9, {3.573606337125*^9, 3.57360634525*^9}, {
   3.573606385328125*^9, 3.573606416390625*^9}, {3.573775814640625*^9, 
   3.573775818390625*^9}, {3.573776602703125*^9, 3.573776607109375*^9}, {
   3.57424591375*^9, 3.574245915484375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "value", " ", "will", " ", "be", " ", "set", " ", "on", " ", 
    "return", " ", "if", " ", "diagnostics", " ", "are", " ", "enabled"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "NelderMeadMinimize`Dump`OperationCounts", "]"}], 
   ";"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.544464299609375*^9, 3.544464320796875*^9}, {
   3.544465547828125*^9, 3.544465548609375*^9}, {3.544465647*^9, 
   3.544465662484375*^9}, {3.544475686015625*^9, 3.544475686734375*^9}, 
   3.5446534856875*^9, {3.573696365984375*^9, 3.573696429390625*^9}, {
   3.573697020484375*^9, 3.5736970205625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Separable", " ", "and", " ", "nonseparable", " ", "hyperellipsoid", " ", 
    "functions"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "NelderMeadMinimize`Dump`Hyperellipsoid", "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "ClearAll", "[", "NelderMeadMinimize`Dump`RotatedHyperellipsoid", "]"}], 
    ";"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.544464299609375*^9, 3.544464320796875*^9}, {
   3.544465547828125*^9, 3.544465548609375*^9}, {3.544465666390625*^9, 
   3.54446567346875*^9}, {3.5444750351875*^9, 3.544475041046875*^9}, {
   3.544475688484375*^9, 3.544475688625*^9}, {3.544637207734375*^9, 
   3.54463720953125*^9}, 3.5446534856875*^9, {3.57369679821875*^9, 
   3.573696805234375*^9}, {3.573696862453125*^9, 3.57369686259375*^9}, {
   3.573955690484375*^9, 3.57395571234375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Rosenbrock", "'"}], "s", " ", "function"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "NelderMeadMinimize`Dump`Rosenbrock", "]"}], 
   ";"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.544464299609375*^9, 3.544464320796875*^9}, {
   3.544465547828125*^9, 3.544465548609375*^9}, {3.544465647*^9, 
   3.544465662484375*^9}, {3.544475686015625*^9, 3.544475686734375*^9}, 
   3.5446534856875*^9, {3.573696365984375*^9, 3.57369638140625*^9}, {
   3.573696808375*^9, 3.57369681784375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.5444649610625*^9, 3.544464983671875*^9}, 
   3.5446534856875*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Caller", " ", "for", " ", "the", " ", "compiled", " ", "Nelder"}], "-", 
    RowBox[{"Mead", " ", "code"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"NelderMeadMinimize", "[", "\[IndentingNewLine]", 
     RowBox[{"minimand_", ",", 
      RowBox[{"vars", ":", 
       RowBox[{"{", "varseq__Symbol", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "NelderMeadMinimize", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"BlockRandom", "@", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"varseq", ",", 
         RowBox[{"dimension", "=", 
          RowBox[{"Length", "[", "vars", "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SeedRandom", "@", 
         RowBox[{"OptionValue", "[", "\"\<RandomSeed\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"compiledMinimizer", "=", 
             RowBox[{
             "NelderMeadMinimize`Dump`CompiledNelderMead", "[", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Switch", "[", 
                RowBox[{
                 RowBox[{"Head", "[", "minimand", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Function", "|", "CompiledFunction"}], ",", 
                 "minimand", ",", "\[IndentingNewLine]", "_", ",", 
                 RowBox[{"Function", "[", 
                  RowBox[{"vars", ",", "minimand"}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], ",", "vars", ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Sort", "@", 
                RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", "opts", "}"}], "~", "Join", "~", 
                   RowBox[{"FilterRules", "[", 
                    RowBox[{
                    RowBox[{"Options", "[", "NelderMeadMinimize", "]"}], ",", 
                    RowBox[{"Except", "[", 
                    RowBox[{"{", "opts", "}"}], "]"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                  "Options", "[", 
                   "NelderMeadMinimize`Dump`CompiledNelderMead", "]"}]}], 
                 "\[IndentingNewLine]", "]"}]}], ",", 
               RowBox[{
               "\"\<ReturnValues\>\"", "\[Rule]", 
                "\"\<AugmentedOptimizedParameters\>\""}]}], 
              "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"initialPoints", "=", 
             RowBox[{"Cases", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"OptionValue", "[", "\"\<InitialPoints\>\"", "]"}], "//",
                 "N"}], ",", "\[IndentingNewLine]", 
               RowBox[{"List", "@", 
                RowBox[{"Repeated", "[", 
                 RowBox[{"_Real", ",", 
                  RowBox[{"{", "dimension", "}"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}], ",", 
               RowBox[{"dimension", "+", "1"}]}], "\[IndentingNewLine]", 
              "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{"result", "=", 
              RowBox[{"compiledMinimizer", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"initialPoints", "~", "Join", "~", 
                 RowBox[{"RandomReal", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"dimension", "+", "1", "-", 
                    RowBox[{"Length", "[", "initialPoints", "]"}]}], ",", 
                    "dimension"}], "}"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                "OptionValue", "[", "\"\<ConvergenceTolerance\>\"", "]"}], 
                ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"#", "===", "Infinity"}], ",", 
                    RowBox[{"-", "1"}], ",", "#"}], "]"}], "&"}], " ", "@", 
                 " ", 
                 RowBox[{
                 "OptionValue", "[", "\"\<MaxIterations\>\"", "]"}]}]}], 
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"First", "[", "result", "]"}], ",", 
              RowBox[{"Thread", "[", 
               RowBox[{"vars", "\[Rule]", 
                RowBox[{"Rest", "[", "result", "]"}]}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.544304295546875*^9, 3.544304401578125*^9}, {
   3.544304448921875*^9, 3.544304479640625*^9}, {3.544309314390625*^9, 
   3.54430936090625*^9}, {3.5443095865*^9, 3.544309589234375*^9}, 
   3.544309664109375*^9, {3.544309701796875*^9, 3.544309703828125*^9}, {
   3.544310554109375*^9, 3.544310554671875*^9}, {3.544313473515625*^9, 
   3.544313492859375*^9}, {3.54431585684375*^9, 3.544315871921875*^9}, {
   3.54431593234375*^9, 3.54431593896875*^9}, {3.5443162161875*^9, 
   3.544316225421875*^9}, {3.544316371484375*^9, 3.54431637340625*^9}, {
   3.544316543265625*^9, 3.544316545203125*^9}, {3.544316825328125*^9, 
   3.544316837375*^9}, {3.54431690971875*^9, 3.544316927078125*^9}, {
   3.544317088140625*^9, 3.544317129140625*^9}, {3.54431755928125*^9, 
   3.544317561421875*^9}, {3.544317748453125*^9, 3.544317750765625*^9}, {
   3.544317831*^9, 3.54431783303125*^9}, {3.544317954875*^9, 
   3.544318009359375*^9}, {3.544318047609375*^9, 3.54431805671875*^9}, {
   3.5443180969375*^9, 3.544318103328125*^9}, {3.5443188235625*^9, 
   3.544318944453125*^9}, {3.544319131453125*^9, 3.544319140390625*^9}, {
   3.544319751484375*^9, 3.54431975184375*^9}, {3.544319839*^9, 
   3.544319860828125*^9}, {3.544320017765625*^9, 3.54432005940625*^9}, {
   3.544320175890625*^9, 3.5443202620625*^9}, {3.54432034765625*^9, 
   3.54432039578125*^9}, 3.54432073384375*^9, {3.54432076990625*^9, 
   3.544320771359375*^9}, {3.54432088875*^9, 3.5443209350625*^9}, {
   3.544323810296875*^9, 3.544323813984375*^9}, {3.5443238634375*^9, 
   3.544323921484375*^9}, {3.5443239685*^9, 3.54432398484375*^9}, {
   3.544324021984375*^9, 3.5443241938125*^9}, {3.544324233359375*^9, 
   3.5443242504375*^9}, {3.5443246478125*^9, 3.544324658484375*^9}, {
   3.54432473203125*^9, 3.544324769703125*^9}, {3.544324912234375*^9, 
   3.54432494328125*^9}, {3.54432498425*^9, 3.544324987375*^9}, {
   3.544325098875*^9, 3.544325101578125*^9}, {3.544325163921875*^9, 
   3.54432527284375*^9}, {3.544325304296875*^9, 3.544325357015625*^9}, {
   3.5443255341875*^9, 3.5443255538125*^9}, {3.544352006444239*^9, 
   3.544352056537989*^9}, {3.544352106537989*^9, 3.5443521078348637`*^9}, {
   3.544352149162989*^9, 3.5443521689911137`*^9}, {3.5443553939598637`*^9, 
   3.5443554293036137`*^9}, {3.544356150537989*^9, 3.5443562035536137`*^9}, {
   3.5443562830848637`*^9, 3.5443563143661137`*^9}, {3.544356402069239*^9, 
   3.5443564551161137`*^9}, {3.544356582287989*^9, 3.5443565830223637`*^9}, {
   3.544357596475489*^9, 3.5443576016473637`*^9}, {3.544357641975489*^9, 
   3.5443576888036137`*^9}, {3.544357941381739*^9, 3.5443579677723637`*^9}, {
   3.544358162819239*^9, 3.5443581647411137`*^9}, {3.544359326631739*^9, 
   3.5443593285223637`*^9}, 3.5443593813036137`*^9, 3.5443594192411137`*^9, {
   3.5443594909598637`*^9, 3.544359491131739*^9}, 3.544359744725489*^9, {
   3.5443598031786137`*^9, 3.5443598425536137`*^9}, 3.544359897600489*^9, {
   3.5443599539286137`*^9, 3.5443599768661137`*^9}, {3.5443600399286137`*^9, 
   3.5443600524911137`*^9}, 3.5443601256161137`*^9, {3.5443603007098637`*^9, 
   3.5443603043661137`*^9}, {3.5443752866161137`*^9, 3.544375323037989*^9}, {
   3.544376487256739*^9, 3.544376492537989*^9}, {3.5443843476786137`*^9, 
   3.5443843551786137`*^9}, {3.544384461194239*^9, 3.544384467006739*^9}, 
   3.5444011286786137`*^9, 3.5444013012098637`*^9, {3.5444013803348637`*^9, 
   3.5444013857411137`*^9}, {3.5444059097411137`*^9, 3.5444059135536137`*^9}, 
   3.54446463978125*^9, {3.544464858421875*^9, 3.544464884859375*^9}, {
   3.5444757678125*^9, 3.54447576903125*^9}, 3.5444758178125*^9, {
   3.544475869359375*^9, 3.5444758796875*^9}, {3.544475932421875*^9, 
   3.54447594334375*^9}, {3.544476067359375*^9, 3.544476122328125*^9}, {
   3.544479605109375*^9, 3.54447961303125*^9}, {3.54464370375*^9, 
   3.5446437095625*^9}, {3.544643883796875*^9, 3.544643956671875*^9}, {
   3.544644013984375*^9, 3.544644055875*^9}, {3.544644252265625*^9, 
   3.5446443376875*^9}, {3.544644376546875*^9, 3.544644513390625*^9}, {
   3.544644552171875*^9, 3.544644605984375*^9}, {3.544644844640625*^9, 
   3.54464484475*^9}, {3.544645008359375*^9, 3.544645070046875*^9}, {
   3.544645114359375*^9, 3.544645202734375*^9}, {3.544645319734375*^9, 
   3.544645348671875*^9}, {3.5446455855*^9, 3.544645586125*^9}, {
   3.54464586721875*^9, 3.544645871421875*^9}, {3.54464591871875*^9, 
   3.544645919703125*^9}, {3.54464736871875*^9, 3.54464737365625*^9}, {
   3.544652436828125*^9, 3.54465247028125*^9}, 3.5446534856875*^9, {
   3.544665585640625*^9, 3.544665586921875*^9}, {3.544750330109375*^9, 
   3.5447503520625*^9}, 3.5452348396875*^9, {3.545269579125*^9, 
   3.54526958859375*^9}, {3.545273655703125*^9, 3.54527368690625*^9}, {
   3.57307672284375*^9, 3.5730767534375*^9}, {3.573081784109375*^9, 
   3.573081785109375*^9}, {3.573081815328125*^9, 3.57308181590625*^9}, {
   3.5730819665625*^9, 3.573082001640625*^9}, {3.5730820514375*^9, 
   3.573082061984375*^9}, {3.573082097109375*^9, 3.573082186578125*^9}, {
   3.573082728640625*^9, 3.573082732859375*^9}, {3.573082790390625*^9, 
   3.5730828295*^9}, {3.573082873296875*^9, 3.573082909109375*^9}, 
   3.57308920225*^9, {3.57309009709375*^9, 3.573090113703125*^9}, {
   3.57311101565625*^9, 3.573111032796875*^9}, {3.5731114260625*^9, 
   3.573111437453125*^9}, {3.573111534734375*^9, 3.573111537265625*^9}, {
   3.573112487390625*^9, 3.57311249396875*^9}, {3.574060733984375*^9, 
   3.574060739515625*^9}, {3.574097038546875*^9, 3.5740970530625*^9}, {
   3.574097273375*^9, 3.574097274546875*^9}, {3.574097339359375*^9, 
   3.57409735771875*^9}, {3.574097470921875*^9, 3.574097472734375*^9}, {
   3.574097638421875*^9, 3.57409764490625*^9}, 3.57409776484375*^9, {
   3.5740978725*^9, 3.57409787853125*^9}, {3.574097964421875*^9, 
   3.574097965796875*^9}, {3.57409883321875*^9, 3.5740989309375*^9}, {
   3.57409899365625*^9, 3.574098995265625*^9}, {3.57409907234375*^9, 
   3.5740990780625*^9}, {3.574099197140625*^9, 3.574099198828125*^9}, 
   3.5740993280625*^9, {3.5740995185625*^9, 3.574099526*^9}, {
   3.57409985359375*^9, 3.57409985915625*^9}, {3.574099915859375*^9, 
   3.574099920265625*^9}, {3.574244880890625*^9, 3.574244888125*^9}, {
   3.574245239421875*^9, 3.574245240609375*^9}, {3.574245296796875*^9, 
   3.574245304421875*^9}, {3.57424557003125*^9, 3.5742455735*^9}, {
   3.5742456176875*^9, 3.574245623421875*^9}, {3.5742571255625*^9, 
   3.574257138515625*^9}, {3.57425734371875*^9, 3.57425734425*^9}, {
   3.5742579191875*^9, 3.57425792728125*^9}, {3.57425804828125*^9, 
   3.57425805228125*^9}, {3.5742582201875*^9, 3.574258242609375*^9}, 
   3.574258296609375*^9, {3.574372435125*^9, 3.574372469703125*^9}, {
   3.5743752231875*^9, 3.57437522834375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Deal", " ", "with", " ", "univariate", " ", "case"}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"NelderMeadMinimize", "[", "\[IndentingNewLine]", 
     RowBox[{"minimand_", ",", "var_Symbol", ",", "\[IndentingNewLine]", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "NelderMeadMinimize", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"NelderMeadMinimize", "[", 
     RowBox[{"minimand", ",", 
      RowBox[{"{", "var", "}"}], ",", "opts"}], "]"}]}], ";"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.544304487671875*^9, 3.54430451771875*^9}, {
   3.54430502671875*^9, 3.54430503525*^9}, 3.544305256375*^9, {
   3.5443054703125*^9, 3.544305475265625*^9}, {3.544309054109375*^9, 
   3.544309085390625*^9}, {3.544310068921875*^9, 3.544310189859375*^9}, {
   3.544310237375*^9, 3.54431028521875*^9}, {3.5443103804375*^9, 
   3.5443103875*^9}, {3.544310875859375*^9, 3.5443108785625*^9}, {
   3.544311246265625*^9, 3.544311268421875*^9}, 3.54431831196875*^9, {
   3.5443561263348637`*^9, 3.544356142912989*^9}, {3.544356588350489*^9, 
   3.544356589819239*^9}, {3.544357835131739*^9, 3.5443578376473637`*^9}, {
   3.5443580423973637`*^9, 3.544358053850489*^9}, {3.5443761356473637`*^9, 
   3.544376144162989*^9}, {3.5443868626473637`*^9, 3.544386885944239*^9}, {
   3.544387015600489*^9, 3.5443870348348637`*^9}, {3.5443870832098637`*^9, 
   3.5443871246786137`*^9}, {3.5444001674598637`*^9, 3.544400181725489*^9}, {
   3.5444002357723637`*^9, 3.544400236725489*^9}, {3.544401063662989*^9, 
   3.5444010670536137`*^9}, {3.544401112194239*^9, 3.5444011194598637`*^9}, 
   3.5444013035848637`*^9, {3.544463362890625*^9, 3.544463364515625*^9}, {
   3.544464594375*^9, 3.544464624140625*^9}, {3.544476211671875*^9, 
   3.544476221859375*^9}, 3.5446534856875*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Produces", " ", "inlinable", " ", "code", " ", "for", " ", "use", " ", 
    "inside", " ", "Compile", " ", 
    RowBox[{"(", 
     RowBox[{
     "where", " ", "Apply", " ", "is", " ", "not", " ", "supported", " ", 
      "directly"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "apply", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"apply", ",", "HoldRest"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"apply", "[", 
      RowBox[{
       RowBox[{"f", ":", 
        RowBox[{"_Function", "|", "_CompiledFunction"}]}], ",", 
       RowBox[{"vars", ":", 
        RowBox[{"{", "___Symbol", "}"}]}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{"args", ",", 
       RowBox[{"Block", "[", 
        RowBox[{"vars", ",", 
         RowBox[{
          RowBox[{"vars", "=", "args"}], ";", 
          RowBox[{"f", "@@", "vars"}]}]}], "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.544372325256739*^9, 3.5443723507098637`*^9}, {
   3.5443724304286137`*^9, 3.5443724601161137`*^9}, {3.5443725765536137`*^9, 
   3.5443726006473637`*^9}, {3.544372690912989*^9, 3.544372723256739*^9}, {
   3.5443727581161137`*^9, 3.5443727613348637`*^9}, {3.5443729011786137`*^9, 
   3.5443729073661137`*^9}, {3.544373005819239*^9, 3.5443730084598637`*^9}, {
   3.544373068694239*^9, 3.5443730761161137`*^9}, {3.544373235600489*^9, 
   3.5443732500536137`*^9}, 3.544373416975489*^9, {3.544373474100489*^9, 
   3.5443734754911137`*^9}, {3.5443735126473637`*^9, 3.544373512756739*^9}, {
   3.544373559006739*^9, 3.544373585319239*^9}, {3.5443737538661137`*^9, 
   3.544373757475489*^9}, {3.5443746288973637`*^9, 3.5443748231473637`*^9}, {
   3.5443748592098637`*^9, 3.544375068694239*^9}, {3.544375330819239*^9, 
   3.5443753555223637`*^9}, {3.544375399225489*^9, 3.5443754046473637`*^9}, {
   3.544375435631739*^9, 3.5443755133348637`*^9}, {3.544375550756739*^9, 
   3.5443756253661137`*^9}, {3.5443757346786137`*^9, 3.544375761975489*^9}, {
   3.5443851020223637`*^9, 3.5443851165223637`*^9}, 3.5446534856875*^9, {
   3.545234759640625*^9, 3.54523477390625*^9}, {3.54526569065625*^9, 
   3.545265692390625*^9}, {3.573952444734375*^9, 3.57395245446875*^9}, {
   3.573952499734375*^9, 3.573952506078125*^9}, 3.573952936609375*^9, 
   3.5739532276875*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Version", "-", 
    RowBox[{"specific", " ", "compilable", " ", "Ordering"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "ordering", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ordering", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"$VersionNumber", "\[GreaterEqual]", "8"}], ",", "Ordering", 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "The", " ", "Mathematica", " ", "6", " ", "and", " ", "7", " ", 
         "runtimes", " ", 
         RowBox[{"don", "'"}], "t", " ", "have", " ", "support", " ", "for", 
         " ", "Ordering"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", "lst", "}"}], ",", 
         RowBox[{"IntegerPart", "@", 
          RowBox[{"Last", "@", 
           RowBox[{"Transpose", "@", 
            RowBox[{"Sort", "@", 
             RowBox[{"Transpose", "[", 
              RowBox[{"{", 
               RowBox[{"lst", ",", 
                RowBox[{"Range", "@", 
                 RowBox[{"Length", "[", "lst", "]"}]}]}], "}"}], 
              "]"}]}]}]}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.544413898537989*^9, 3.544413919225489*^9}, {
   3.544413954350489*^9, 3.5444139593973637`*^9}, {3.544414045600489*^9, 
   3.5444140522723637`*^9}, 3.5444142754598637`*^9, {3.54446456796875*^9, 
   3.544464576640625*^9}, 3.5446534856875*^9, 3.54527511728125*^9, {
   3.5455877536324053`*^9, 3.5455877544761553`*^9}, {3.5455878058355303`*^9, 
   3.5455878181011553`*^9}, {3.5455879212574053`*^9, 
   3.5455879474449053`*^9}, {3.5455880874917803`*^9, 
   3.5455880928355303`*^9}, {3.5455881421324053`*^9, 
   3.5455881681949053`*^9}, {3.5455933456324053`*^9, 
   3.5455933481480303`*^9}, {3.5455934431167803`*^9, 
   3.5455934586167803`*^9}, {3.5455981261324053`*^9, 
   3.5455981461949053`*^9}, {3.5455981792730303`*^9, 
   3.5455982059917803`*^9}, {3.5455983129605303`*^9, 
   3.5455983158511553`*^9}, {3.5455985564761553`*^9, 
   3.5455985676011553`*^9}, {3.5455987033824053`*^9, 
   3.5455987035386553`*^9}, {3.5455987927261553`*^9, 
   3.5455987955699053`*^9}, {3.5455988679917803`*^9, 
   3.5455988756792803`*^9}, {3.5455990453511553`*^9, 
   3.5455990813980303`*^9}, {3.545866560453125*^9, 3.545866560671875*^9}, {
   3.5458671788125*^9, 3.5458671950625*^9}, {3.545867853390625*^9, 
   3.5458678605*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Inlinable", " ", "utility", " ", "function"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "meanAbsoluteDifferences", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"meanAbsoluteDifferences", "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"$VersionNumber", "\[GreaterEqual]", "8"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", "lst", "}"}], ",", 
         RowBox[{"Mean", "@", 
          RowBox[{"Abs", "@", 
           RowBox[{"Differences", "[", "lst", "]"}]}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", "lst", "}"}], ",", 
         RowBox[{
          RowBox[{"Plus", "@@", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"Most", "[", "lst", "]"}], "-", 
             RowBox[{"Rest", "[", "lst", "]"}]}], "]"}]}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "lst", "]"}], "-", "1"}], ")"}]}]}], 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.544413898537989*^9, 3.544413919225489*^9}, {
   3.544413954350489*^9, 3.5444139593973637`*^9}, {3.544414045600489*^9, 
   3.5444140522723637`*^9}, 3.5444142754598637`*^9, {3.54446456796875*^9, 
   3.544464576640625*^9}, 3.5446534856875*^9, 3.54527511728125*^9, {
   3.5455878400230303`*^9, 3.5455878409136553`*^9}, {3.5455879745074053`*^9, 
   3.5455879808980303`*^9}, {3.5455880124917803`*^9, 
   3.5455880807417803`*^9}, {3.5455881311167803`*^9, 3.5455881361480303`*^9}, 
   3.5455881749292803`*^9, {3.5455885167886553`*^9, 3.5455885271636553`*^9}, {
   3.5455887969605303`*^9, 3.5455888020074053`*^9}, {3.5455912786480303`*^9, 
   3.5455913142574053`*^9}, {3.5455913714761553`*^9, 
   3.5455914070542803`*^9}, {3.5455932440230303`*^9, 
   3.5455932475699053`*^9}, {3.5455932794292803`*^9, 
   3.5455933353355303`*^9}, {3.5455934498667803`*^9, 
   3.5455934546011553`*^9}, {3.5455989035230303`*^9, 
   3.5455989084292803`*^9}, {3.5455989551636553`*^9, 
   3.5455989563355303`*^9}, {3.5458664705625*^9, 3.54586647325*^9}, {
   3.5732277113837075`*^9, 3.573227712368083*^9}, 3.5732284283524575`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Produces", " ", "compiled", " ", "code", " ", "for", " ", "the", " ", 
     "Nelder"}], "-", 
    RowBox[{
    "Mead", " ", "algorithm", " ", "with", " ", "the", " ", "objective", " ", 
     "function", " ", "inlined"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "NelderMeadMinimize`Dump`CompiledNelderMead", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"objectiveFunction", ":", 
       RowBox[{"_Function", "|", "_CompiledFunction"}]}], ",", 
      RowBox[{"vars", ":", 
       RowBox[{"{", "__Symbol", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"opts", ":", 
       RowBox[{
       "OptionsPattern", "[", "NelderMeadMinimize`Dump`CompiledNelderMead", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "NelderMeadMinimize`Dump`CompiledNelderMead", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Verbatim", "[", "objectiveFunction", "]"}], ",", "vars", ",", 
       "\[IndentingNewLine]", "opts"}], "\[IndentingNewLine]", "]"}], "=", 
     "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Inlined", " ", "option", " ", "values"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"historyLength", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", "===", "Automatic"}], ",", 
              RowBox[{"10", 
               RowBox[{"Length", "[", "vars", "]"}]}], ",", "#"}], "]"}], 
            "&"}], " ", "@", " ", 
           RowBox[{"OptionValue", "[", "\"\<HistoryLength\>\"", "]"}]}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"reflectRatio", "=", 
          RowBox[{"OptionValue", "[", "\"\<ReflectRatio\>\"", "]"}]}], ",", 
         RowBox[{"expandRatio", "=", 
          RowBox[{"OptionValue", "[", "\"\<ExpandRatio\>\"", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"contractRatio", "=", 
          RowBox[{"OptionValue", "[", "\"\<ContractRatio\>\"", "]"}]}], ",", 
         RowBox[{"shrinkRatio", "=", 
          RowBox[{"OptionValue", "[", "\"\<ShrinkRatio\>\"", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Other", " ", "inlined", " ", "values"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"origin", "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0.", ",", 
            RowBox[{"Length", "[", "vars", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"infinity", "=", "$MaxMachineNumber"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"epsilon", "=", "$MachineEpsilon"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Inlined", " ", "functions"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"f", "=", 
          RowBox[{"apply", "[", 
           RowBox[{"objectiveFunction", ",", "vars"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ordering", "=", "ordering"}], ",", "\[IndentingNewLine]", 
         RowBox[{"meanAbsoluteDifferences", "=", "meanAbsoluteDifferences"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Return", " ", "values"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"return", "=", 
          RowBox[{"Switch", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<ReturnValues\>\"", "]"}], ",", 
            "\[IndentingNewLine]", "\"\<OptimizedParameters\>\"", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Null", ",", 
              RowBox[{
              "simplex", "\[LeftDoubleBracket]", "best", 
               "\[RightDoubleBracket]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\"\<AugmentedOptimizedParameters\>\"", 
            ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Null", ",", 
              RowBox[{
               RowBox[{
               "simplex", "\[LeftDoubleBracket]", "best", 
                "\[RightDoubleBracket]"}], "~", "Prepend", "~", 
               RowBox[{
               "values", "\[LeftDoubleBracket]", "best", 
                "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", "\"\<Simplex\>\"", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Null", ",", "simplex"}], "]"}], ",", 
            "\[IndentingNewLine]", "\"\<AugmentedSimplex\>\"", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"Null", ",", 
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", "simplex", "]"}], "~", "Prepend", 
                "~", "values"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
            "_", ",", 
            RowBox[{"Function", "[", "Null", "]"}]}], "\[IndentingNewLine]", 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Code", " ", "transformations", " ", "to", " ", "be", " ", 
           "applied", " ", "before", " ", "compilation"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"transformations", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"TrueQ", "@", 
             RowBox[{"OptionValue", "[", "\"\<Diagnostics\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"HoldPattern", "[", 
              RowBox[{"h_", "[", 
               RowBox[{"pre___", ",", 
                RowBox[{"diagnostic", "[", "diags___", "]"}], ",", 
                "post___"}], "]"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"h", "[", 
              RowBox[{"pre", ",", "diags", ",", "post"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"HoldPattern", "[", 
              RowBox[{"h_", "[", 
               RowBox[{"pre___", ",", "__diagnostic", ",", "post___"}], "]"}],
               "]"}], "\[RuleDelayed]", 
             RowBox[{"h", "[", 
              RowBox[{"pre", ",", "post"}], "]"}]}]}], "\[IndentingNewLine]", 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Options", " ", "passed", " ", "to", " ", "Compile"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"compileOpts", "=", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"$VersionNumber", "\[GreaterEqual]", "8"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "Mathematica", " ", "8", " ", "and", " ", "above", " ", 
                "offer", " ", "improved", " ", "behaviour", " ", "using", " ",
                 "these", " ", "options"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"CompilationOptions", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "\"\<ExpressionOptimization\>\"", "\[Rule]", "True"}], ",", 
                  RowBox[{
                  "\"\<InlineCompiledFunctions\>\"", "\[Rule]", "True"}]}], 
                 "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"RuntimeOptions", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "\"\<CompareWithTolerance\>\"", "\[Rule]", "False"}], ",", 
                  RowBox[{
                  "\"\<EvaluateSymbolically\>\"", "\[Rule]", "False"}]}], 
                 "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"CompilationTarget", "\[Rule]", 
                RowBox[{"OptionValue", "[", "CompilationTarget", "]"}]}]}], 
              "\[IndentingNewLine]", "}"}], ",", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "Undocumented", " ", "optimization", " ", "level", " ", 
                "option", " ", "for", " ", "Mathematica", " ", "6", " ", 
                "and", " ", "7"}], " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"\"\<CompileOptimizations\>\"", "\[Rule]", "All"}], 
              "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
            "]"}]}]}]}], "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Compile", "@@", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Hold", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"initialSimplex", ",", "_Real", ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"tolerance", ",", "_Real", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"maxIterations", ",", "_Integer", ",", "0"}], "}"}]}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", "Housekeeping", " ", "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"history", "=", 
                 RowBox[{"Table", "[", 
                  RowBox[{"infinity", ",", 
                   RowBox[{"{", "historyLength", "}"}]}], "]"}]}], ",", 
                RowBox[{"iteration", "=", "maxIterations"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"Basic", " ", "quantities"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"simplex", "=", "initialSimplex"}], ",", 
                RowBox[{"values", "=", 
                 RowBox[{"f", "/@", "initialSimplex"}]}], ",", "order", ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "Calculated", " ", "points", " ", "and", " ", "function", 
                  " ", "values"}], " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{"centroid", "=", "origin"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"reflectedPoint", "=", "origin"}], ",", 
                RowBox[{"reflectedValue", "=", "infinity"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"expandedPoint", "=", "origin"}], ",", 
                RowBox[{"expandedValue", "=", "infinity"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"contractedPoint", "=", "origin"}], ",", 
                RowBox[{"contractedValue", "=", "infinity"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "More", " ", "readable", " ", "indices", " ", "into", " ", 
                  "the", " ", "simplex", " ", "array"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"best", "=", "1"}], ",", 
                RowBox[{"worst", "=", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"rest", "=", 
                 RowBox[{"Range", "[", 
                  RowBox[{"2", ",", 
                   RowBox[{"Length", "[", "initialSimplex", "]"}]}], "]"}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"diagnostic", "[", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"Operation", " ", "counts"}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"evaluations", "=", 
                   RowBox[{"Length", "[", "initialSimplex", "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"reflections", "=", "0"}], ",", 
                  RowBox[{"expansions", "=", "0"}], ",", 
                  RowBox[{"contractions", "=", "0"}], ",", 
                  RowBox[{"shrinkages", "=", "0"}]}], "\[IndentingNewLine]", 
                 "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"While", "[", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "Order", " ", "simplex", " ", "points", " ", "by", " ", 
                  "function", " ", "value"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"order", "=", 
                   RowBox[{"ordering", "[", "values", "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"values", "=", 
                   RowBox[{
                   "values", "\[LeftDoubleBracket]", "order", 
                    "\[RightDoubleBracket]"}]}], ";", 
                  RowBox[{"simplex", "=", 
                   RowBox[{
                   "simplex", "\[LeftDoubleBracket]", "order", 
                    "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                   "Decrement", " ", "and", " ", "test", " ", "iterator"}], 
                   " ", "*)"}], "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"iteration", "--"}], ")"}], "\[NotEqual]", 
                   "0"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"Check", " ", "for", " ", "convergence"}], " ", 
                  "*)"}], "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "history", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "=", 
                   RowBox[{
                   "values", "\[LeftDoubleBracket]", "best", 
                    "\[RightDoubleBracket]"}]}], ";", 
                  RowBox[{"history", "=", 
                   RowBox[{"RotateLeft", "[", "history", "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"meanAbsoluteDifferences", "[", "history", "]"}], 
                    "\[LessEqual]", 
                    RowBox[{"tolerance", "+", 
                    RowBox[{"epsilon", " ", 
                    RowBox[{
                    "meanAbsoluteDifferences", "[", "history", "]"}]}]}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Break", "[", "]"}]}], "\[IndentingNewLine]", 
                   "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                   "Find", " ", "centroid", " ", "of", " ", "best", " ", 
                    RowBox[{"(", 
                    RowBox[{"N", " ", "-", " ", "1"}], ")"}], " ", "points"}],
                    " ", "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"centroid", "=", 
                   RowBox[{"Mean", "@", 
                    RowBox[{"Most", "[", "simplex", "]"}]}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", "Reflect", " ", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"reflectedPoint", "=", 
                   RowBox[{"centroid", "+", 
                    RowBox[{"reflectRatio", 
                    RowBox[{"(", 
                    RowBox[{"centroid", "-", 
                    RowBox[{
                    "simplex", "\[LeftDoubleBracket]", "worst", 
                    "\[RightDoubleBracket]"}]}], ")"}]}]}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"reflectedValue", "=", 
                   RowBox[{"f", "[", "reflectedPoint", "]"}]}], ";", 
                  RowBox[{"diagnostic", "[", 
                   RowBox[{"++", "evaluations"}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    "values", "\[LeftDoubleBracket]", "best", 
                    "\[RightDoubleBracket]"}], "\[LessEqual]", 
                    "reflectedValue", "<", 
                    RowBox[{"values", "\[LeftDoubleBracket]", 
                    RowBox[{"-", "2"}], "\[RightDoubleBracket]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "values", "\[LeftDoubleBracket]", "worst", 
                    "\[RightDoubleBracket]"}], "=", "reflectedValue"}], ";", 
                    RowBox[{
                    RowBox[{
                    "simplex", "\[LeftDoubleBracket]", "worst", 
                    "\[RightDoubleBracket]"}], "=", "reflectedPoint"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"diagnostic", "[", 
                    RowBox[{"++", "reflections"}], "]"}], ";", 
                    RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]",
                    "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", "Expand", " ", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"reflectedValue", "<", 
                    RowBox[{
                    "values", "\[LeftDoubleBracket]", "best", 
                    "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"expandedPoint", "=", 
                    RowBox[{"centroid", "+", 
                    RowBox[{"expandRatio", 
                    RowBox[{"(", 
                    RowBox[{"reflectedPoint", "-", "centroid"}], ")"}]}]}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"expandedValue", "=", 
                    RowBox[{"f", "[", "expandedPoint", "]"}]}], ";", 
                    RowBox[{"diagnostic", "[", 
                    RowBox[{"++", "evaluations"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"expandedValue", "<", "reflectedValue"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "values", "\[LeftDoubleBracket]", "worst", 
                    "\[RightDoubleBracket]"}], "=", "expandedValue"}], ";", 
                    RowBox[{
                    RowBox[{
                    "simplex", "\[LeftDoubleBracket]", "worst", 
                    "\[RightDoubleBracket]"}], "=", "expandedPoint"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"diagnostic", "[", 
                    RowBox[{"++", "expansions"}], "]"}], ";", 
                    RowBox[{"Continue", "[", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "values", "\[LeftDoubleBracket]", "worst", 
                    "\[RightDoubleBracket]"}], "=", "reflectedValue"}], ";", 
                    RowBox[{
                    RowBox[{
                    "simplex", "\[LeftDoubleBracket]", "worst", 
                    "\[RightDoubleBracket]"}], "=", "reflectedPoint"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"diagnostic", "[", 
                    RowBox[{"++", "reflections"}], "]"}], ";", 
                    RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]",
                     "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", "Contract", " ", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"reflectedValue", "<", 
                    RowBox[{
                    "values", "\[LeftDoubleBracket]", "worst", 
                    "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"Outside", " ", "contraction"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"contractedPoint", "=", 
                    RowBox[{"centroid", "+", 
                    RowBox[{"contractRatio", 
                    RowBox[{"(", 
                    RowBox[{"reflectedPoint", "-", "centroid"}], ")"}]}]}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"contractedValue", "=", 
                    RowBox[{"f", "[", "contractedPoint", "]"}]}], ";", 
                    RowBox[{"diagnostic", "[", 
                    RowBox[{"++", "evaluations"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    "contractedValue", "\[LessEqual]", "reflectedValue"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "values", "\[LeftDoubleBracket]", "worst", 
                    "\[RightDoubleBracket]"}], "=", "contractedValue"}], ";", 
                    RowBox[{
                    RowBox[{
                    "simplex", "\[LeftDoubleBracket]", "worst", 
                    "\[RightDoubleBracket]"}], "=", "contractedPoint"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"diagnostic", "[", 
                    RowBox[{"++", "contractions"}], "]"}], ";", 
                    RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]",
                     "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"Inside", " ", "contraction"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"contractedPoint", "=", 
                    RowBox[{"centroid", "-", 
                    RowBox[{"contractRatio", 
                    RowBox[{"(", 
                    RowBox[{"centroid", "-", 
                    RowBox[{
                    "simplex", "\[LeftDoubleBracket]", "worst", 
                    "\[RightDoubleBracket]"}]}], ")"}]}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"contractedValue", "=", 
                    RowBox[{"f", "[", "contractedPoint", "]"}]}], ";", 
                    RowBox[{"diagnostic", "[", 
                    RowBox[{"++", "evaluations"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"contractedValue", "<", 
                    RowBox[{
                    "values", "\[LeftDoubleBracket]", "worst", 
                    "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "values", "\[LeftDoubleBracket]", "worst", 
                    "\[RightDoubleBracket]"}], "=", "contractedValue"}], ";", 
                    RowBox[{
                    RowBox[{
                    "simplex", "\[LeftDoubleBracket]", "worst", 
                    "\[RightDoubleBracket]"}], "=", "contractedPoint"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"diagnostic", "[", 
                    RowBox[{"++", "contractions"}], "]"}], ";", 
                    RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]",
                     "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", "Shrink", " ", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                   "simplex", "\[LeftDoubleBracket]", "rest", 
                    "\[RightDoubleBracket]"}], "=", 
                   RowBox[{
                    RowBox[{
                    "simplex", "\[LeftDoubleBracket]", "best", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{"shrinkRatio", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "simplex", "\[LeftDoubleBracket]", "rest", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    "simplex", "\[LeftDoubleBracket]", "best", 
                    "\[RightDoubleBracket]"}]}], ")"}]}]}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                   "values", "\[LeftDoubleBracket]", "rest", 
                    "\[RightDoubleBracket]"}], "=", 
                   RowBox[{"f", "/@", 
                    RowBox[{
                    "simplex", "\[LeftDoubleBracket]", "rest", 
                    "\[RightDoubleBracket]"}]}]}], ";", 
                  RowBox[{"diagnostic", "[", 
                   RowBox[{"evaluations", "+=", 
                    RowBox[{"Length", "[", "rest", "]"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"diagnostic", "[", 
                   RowBox[{"++", "shrinkages"}], "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"diagnostic", "[", "\[IndentingNewLine]", 
                RowBox[{"NelderMeadMinimize`Dump`OperationCounts", "=", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                   "\"\<Function evaluations\>\"", "\[Rule]", "evaluations"}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{"\"\<Reflections\>\"", "\[Rule]", "reflections"}], 
                   ",", 
                   RowBox[{"\"\<Expansions\>\"", "\[Rule]", "expansions"}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{
                   "\"\<Contractions\>\"", "\[Rule]", "contractions"}], ",", 
                   RowBox[{"\"\<Shrinkages\>\"", "\[Rule]", "shrinkages"}]}], 
                  "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"return", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}],
             ",", "compileOpts"}], "\[IndentingNewLine]", "]"}], "//.", 
          "transformations"}], "\[IndentingNewLine]", ")"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.544360411287989*^9, 3.544360463850489*^9}, {
   3.544360502662989*^9, 3.5443606004598637`*^9}, {3.544360651225489*^9, 
   3.544360658725489*^9}, {3.544360726131739*^9, 3.544360805319239*^9}, {
   3.544360847131739*^9, 3.544360854412989*^9}, {3.544361029819239*^9, 
   3.544361076037989*^9}, {3.5443611475536137`*^9, 3.544361165225489*^9}, {
   3.5443612348661137`*^9, 3.544361269600489*^9}, {3.544361845444239*^9, 
   3.5443618700223637`*^9}, {3.544361917069239*^9, 3.544362008256739*^9}, {
   3.544362051100489*^9, 3.544362062569239*^9}, {3.5443628685536137`*^9, 
   3.544362892537989*^9}, 3.5443629310536137`*^9, {3.5443629953036137`*^9, 
   3.5443630429911137`*^9}, {3.544363087631739*^9, 3.544363089194239*^9}, {
   3.5443631483348637`*^9, 3.544363163475489*^9}, {3.544363203162989*^9, 
   3.5443632291786137`*^9}, {3.544363387100489*^9, 3.544363398569239*^9}, {
   3.5443634693661137`*^9, 3.544363469475489*^9}, {3.5443635945223637`*^9, 
   3.544363595850489*^9}, {3.5443636686786137`*^9, 3.544363674537989*^9}, {
   3.544364342412989*^9, 3.5443643597098637`*^9}, {3.5443646430223637`*^9, 
   3.5443646619286137`*^9}, {3.5443650827411137`*^9, 3.544365125569239*^9}, {
   3.5443652993348637`*^9, 3.544365304444239*^9}, {3.5443653392411137`*^9, 
   3.544365376225489*^9}, {3.544365747256739*^9, 3.5443657811161137`*^9}, {
   3.5443658421473637`*^9, 3.5443659243348637`*^9}, 3.5443661684911137`*^9, {
   3.544366461787989*^9, 3.5443665416786137`*^9}, {3.544366760350489*^9, 
   3.544366767069239*^9}, {3.544367134100489*^9, 3.544367172287989*^9}, {
   3.5443672856161137`*^9, 3.544367300819239*^9}, {3.544367717037989*^9, 
   3.5443677241786137`*^9}, {3.5443677559598637`*^9, 3.544367774162989*^9}, {
   3.544368053381739*^9, 3.5443683341786137`*^9}, 3.544368527069239*^9, {
   3.544368557381739*^9, 3.5443685829911137`*^9}, 3.544368614756739*^9, {
   3.5443687098661137`*^9, 3.5443687131473637`*^9}, {3.5443732746786137`*^9, 
   3.544373281850489*^9}, {3.544373479350489*^9, 3.5443734798973637`*^9}, {
   3.5443735219911137`*^9, 3.544373522725489*^9}, {3.544374626069239*^9, 
   3.544374627069239*^9}, 3.544375073694239*^9, {3.544375141881739*^9, 
   3.544375156537989*^9}, 3.544375190162989*^9, {3.544376562787989*^9, 
   3.5443766339911137`*^9}, {3.544376671256739*^9, 3.5443766826786137`*^9}, {
   3.5443767380223637`*^9, 3.544376759162989*^9}, {3.544376818381739*^9, 
   3.544376849381739*^9}, {3.544376963600489*^9, 3.544376981319239*^9}, {
   3.5443770365848637`*^9, 3.5443771674911137`*^9}, {3.544377204506739*^9, 
   3.5443772064286137`*^9}, {3.544377332319239*^9, 3.544377400881739*^9}, {
   3.5443774319598637`*^9, 3.5443774885848637`*^9}, {3.544377520756739*^9, 
   3.544377527787989*^9}, {3.544377580694239*^9, 3.544377585475489*^9}, {
   3.544377623225489*^9, 3.544377642787989*^9}, {3.544377685600489*^9, 
   3.544377759787989*^9}, {3.5443783395848637`*^9, 3.544378447350489*^9}, {
   3.5443785718973637`*^9, 3.544378728350489*^9}, {3.544378818475489*^9, 
   3.5443788984598637`*^9}, {3.5443789600848637`*^9, 3.544378986787989*^9}, {
   3.5443790528348637`*^9, 3.544379166037989*^9}, {3.5443792001786137`*^9, 
   3.544379230037989*^9}, {3.5443792887411137`*^9, 3.544379293069239*^9}, {
   3.544379412506739*^9, 3.544379599037989*^9}, {3.5443796415223637`*^9, 
   3.5443796828348637`*^9}, {3.5443797212098637`*^9, 
   3.5443798181473637`*^9}, {3.544379942444239*^9, 3.5443799734598637`*^9}, {
   3.5443800418036137`*^9, 3.5443800464911137`*^9}, {3.544380106506739*^9, 
   3.5443801640536137`*^9}, {3.5443802665223637`*^9, 3.544380334506739*^9}, 
   3.544380412506739*^9, {3.544380464819239*^9, 3.544380467162989*^9}, {
   3.544380550944239*^9, 3.5443805924598637`*^9}, {3.544380682600489*^9, 
   3.544380744881739*^9}, {3.544380824006739*^9, 3.5443808560223637`*^9}, {
   3.544380925912989*^9, 3.5443809473348637`*^9}, {3.5443811450223637`*^9, 
   3.5443812884286137`*^9}, {3.5443813423036137`*^9, 3.544381417444239*^9}, {
   3.544381453225489*^9, 3.544381456787989*^9}, {3.5443815070536137`*^9, 
   3.544381548100489*^9}, {3.5443815790223637`*^9, 3.544381794506739*^9}, {
   3.5443818474911137`*^9, 3.5443819318661137`*^9}, {3.544382052756739*^9, 
   3.544382186631739*^9}, {3.544382217569239*^9, 3.544382228006739*^9}, {
   3.5443822978348637`*^9, 3.544382319631739*^9}, {3.544382362881739*^9, 
   3.544382437725489*^9}, {3.5443824894598637`*^9, 3.544382511537989*^9}, 
   3.544382600819239*^9, {3.544382701287989*^9, 3.544382712912989*^9}, {
   3.5443827518661137`*^9, 3.544382768975489*^9}, 3.544382822600489*^9, {
   3.5443828644911137`*^9, 3.5443828814911137`*^9}, {3.544382933662989*^9, 
   3.544382944412989*^9}, {3.544382983819239*^9, 3.544383017256739*^9}, {
   3.5443830497098637`*^9, 3.544383051256739*^9}, {3.544383091944239*^9, 
   3.5443832335223637`*^9}, {3.544383265100489*^9, 3.5443833490536137`*^9}, {
   3.5443834252411137`*^9, 3.544383641694239*^9}, {3.5443836947098637`*^9, 
   3.5443837228661137`*^9}, {3.544383762506739*^9, 3.5443838098348637`*^9}, {
   3.5443842287411137`*^9, 3.544384290569239*^9}, {3.5443843213348637`*^9, 
   3.5443843248661137`*^9}, {3.5443852655848637`*^9, 3.544385276912989*^9}, {
   3.5443855280223637`*^9, 3.544385530475489*^9}, {3.544385614162989*^9, 
   3.5443856229286137`*^9}, {3.544385684850489*^9, 3.544385699756739*^9}, {
   3.544386059912989*^9, 3.5443860620848637`*^9}, {3.544386138225489*^9, 
   3.544386139756739*^9}, {3.5443862015848637`*^9, 3.544386203694239*^9}, {
   3.544386296944239*^9, 3.5443862978973637`*^9}, {3.544386696162989*^9, 
   3.544386735631739*^9}, 3.5443868123348637`*^9, {3.5443872216786137`*^9, 
   3.544387358100489*^9}, {3.5443876211786137`*^9, 3.544387690444239*^9}, {
   3.544387771194239*^9, 3.544387820944239*^9}, {3.544387856100489*^9, 
   3.544387859850489*^9}, {3.5443879321786137`*^9, 3.5443879629286137`*^9}, {
   3.5443880648973637`*^9, 3.5443881846473637`*^9}, {3.544388999569239*^9, 
   3.544389014850489*^9}, {3.544389165694239*^9, 3.5443891932411137`*^9}, {
   3.5443894152411137`*^9, 3.5443894259286137`*^9}, {3.544391175475489*^9, 
   3.5443911788661137`*^9}, 3.544391331412989*^9, {3.544392799756739*^9, 
   3.544392878600489*^9}, {3.544392943975489*^9, 3.544393018350489*^9}, {
   3.5443942528348637`*^9, 3.544394280881739*^9}, {3.5443945439286137`*^9, 
   3.544394550694239*^9}, {3.5443977688348637`*^9, 3.544397773600489*^9}, {
   3.544397812506739*^9, 3.5443978313036137`*^9}, {3.5443979918036137`*^9, 
   3.544398009194239*^9}, {3.544398121850489*^9, 3.544398129319239*^9}, {
   3.544398166600489*^9, 3.5443981757411137`*^9}, {3.544398260819239*^9, 
   3.5443982657411137`*^9}, {3.5443983232098637`*^9, 
   3.5443984323661137`*^9}, {3.544398507037989*^9, 3.5443985076786137`*^9}, {
   3.544398562100489*^9, 3.544398562631739*^9}, {3.5443988066786137`*^9, 
   3.5443988086786137`*^9}, {3.544398883506739*^9, 3.544398885194239*^9}, {
   3.544398971881739*^9, 3.544398978412989*^9}, {3.544399397881739*^9, 
   3.544399398256739*^9}, 3.544399455319239*^9, {3.5443995025223637`*^9, 
   3.544399503006739*^9}, {3.544399604944239*^9, 3.544399605569239*^9}, {
   3.5443997203036137`*^9, 3.5443997209911137`*^9}, {3.544399794569239*^9, 
   3.544399795225489*^9}, {3.544400575881739*^9, 3.544400606444239*^9}, {
   3.544401391037989*^9, 3.5444014043973637`*^9}, {3.5444016175536137`*^9, 
   3.544401656069239*^9}, {3.5444018515223637`*^9, 3.5444018849911137`*^9}, {
   3.5444019465536137`*^9, 3.544402067131739*^9}, {3.5444021155223637`*^9, 
   3.544402189537989*^9}, {3.5444022613661137`*^9, 3.5444023607098637`*^9}, {
   3.5444023945536137`*^9, 3.544402412569239*^9}, {3.544402478225489*^9, 
   3.544402501131739*^9}, {3.544402544912989*^9, 3.5444025487723637`*^9}, {
   3.544402718787989*^9, 3.5444027274911137`*^9}, {3.544405242881739*^9, 
   3.544405245631739*^9}, {3.5444058059286137`*^9, 3.544405825537989*^9}, {
   3.5444141968973637`*^9, 3.544414218381739*^9}, {3.5444142573348637`*^9, 
   3.544414270850489*^9}, {3.5444143450223637`*^9, 3.5444143836161137`*^9}, {
   3.5444144243348637`*^9, 3.5444144271473637`*^9}, {3.5444144732098637`*^9, 
   3.5444144782723637`*^9}, {3.5444145428661137`*^9, 
   3.5444145875223637`*^9}, {3.544414636569239*^9, 3.544414642319239*^9}, {
   3.544414717600489*^9, 3.5444147495223637`*^9}, {3.54443396553125*^9, 
   3.544434076734375*^9}, {3.54443440365625*^9, 3.544434466*^9}, {
   3.5444347775625*^9, 3.544434793015625*^9}, {3.54443492809375*^9, 
   3.544434935546875*^9}, {3.54443502996875*^9, 3.544435045453125*^9}, 
   3.5444364450625*^9, {3.544463289171875*^9, 3.54446329078125*^9}, 
   3.54446332809375*^9, {3.5444643005*^9, 3.544464318109375*^9}, {
   3.54446467553125*^9, 3.54446475859375*^9}, {3.544465176484375*^9, 
   3.54446517940625*^9}, {3.544465549359375*^9, 3.544465549984375*^9}, {
   3.54446575646875*^9, 3.544465765953125*^9}, {3.544477652859375*^9, 
   3.54447768575*^9}, {3.54447775965625*^9, 3.5444777758125*^9}, {
   3.5444793258125*^9, 3.544479446640625*^9}, {3.544479513828125*^9, 
   3.544479564703125*^9}, {3.54447963575*^9, 3.54447964678125*^9}, {
   3.544479894078125*^9, 3.54447991384375*^9}, {3.544480111015625*^9, 
   3.5444801601875*^9}, {3.544480259578125*^9, 3.544480274984375*^9}, {
   3.544480321984375*^9, 3.54448035875*^9}, {3.544480403171875*^9, 
   3.544480427953125*^9}, {3.544480902171875*^9, 3.544480919109375*^9}, {
   3.544635587078125*^9, 3.54463559871875*^9}, {3.5446415543125*^9, 
   3.544641557546875*^9}, {3.54464164109375*^9, 3.5446416685*^9}, {
   3.544641766140625*^9, 3.54464178259375*^9}, {3.544642105*^9, 
   3.544642143515625*^9}, {3.544643978296875*^9, 3.544643984109375*^9}, {
   3.5446526144375*^9, 3.5446526163125*^9}, 3.544652656703125*^9, 
   3.5446534856875*^9, {3.544665612734375*^9, 3.544665614671875*^9}, {
   3.5446663010625*^9, 3.544666302359375*^9}, {3.54466664678125*^9, 
   3.544666702*^9}, {3.54466761753125*^9, 3.544667644328125*^9}, {
   3.5446676925*^9, 3.544667695703125*^9}, 3.544667738375*^9, 
   3.544667776046875*^9, {3.5446678226875*^9, 3.54466790878125*^9}, {
   3.5446680093125*^9, 3.544668055921875*^9}, {3.544668105078125*^9, 
   3.5446681083125*^9}, 3.54466815453125*^9, {3.544668275546875*^9, 
   3.544668280296875*^9}, {3.54466839125*^9, 3.544668393921875*^9}, {
   3.54466849215625*^9, 3.544668492703125*^9}, {3.544671468359375*^9, 
   3.544671477703125*^9}, {3.54472534540625*^9, 3.544725391796875*^9}, {
   3.5452349478125*^9, 3.54523497384375*^9}, {3.5452352104375*^9, 
   3.545235231859375*^9}, {3.54524406625*^9, 3.5452440729375*^9}, {
   3.545244172609375*^9, 3.54524417275*^9}, {3.545245890625*^9, 
   3.54524591453125*^9}, {3.54524601646875*^9, 3.545246064203125*^9}, {
   3.54524612578125*^9, 3.545246151984375*^9}, {3.54524645078125*^9, 
   3.5452464535*^9}, {3.54524666340625*^9, 3.545246691234375*^9}, {
   3.54524845384375*^9, 3.5452484635*^9}, {3.545248535859375*^9, 
   3.54524854053125*^9}, {3.545249292875*^9, 3.545249300640625*^9}, {
   3.545249450515625*^9, 3.545249452109375*^9}, {3.5452495369375*^9, 
   3.545249553109375*^9}, {3.545249615484375*^9, 3.545249685828125*^9}, {
   3.545263349796875*^9, 3.54526335778125*^9}, {3.54526339809375*^9, 
   3.5452634195*^9}, {3.545263489546875*^9, 3.54526349084375*^9}, {
   3.54526564684375*^9, 3.54526568728125*^9}, {3.545270542828125*^9, 
   3.545270543265625*^9}, {3.545270895859375*^9, 3.545270911890625*^9}, {
   3.545271169546875*^9, 3.545271180078125*^9}, {3.545271326984375*^9, 
   3.54527132965625*^9}, {3.54527136603125*^9, 3.545271392171875*^9}, {
   3.54527277375*^9, 3.545272790515625*^9}, {3.545273007359375*^9, 
   3.5452730188125*^9}, {3.545337491796875*^9, 3.545337495234375*^9}, {
   3.5455884643824053`*^9, 3.5455884811480303`*^9}, {3.5455886169292803`*^9, 
   3.5455886262730303`*^9}, {3.5455886581792803`*^9, 
   3.5455886582730303`*^9}, {3.5455888244917803`*^9, 3.5455888414761553`*^9}, 
   3.5455914226792803`*^9, {3.5455914681636553`*^9, 3.5455914961636553`*^9}, {
   3.5455925297105303`*^9, 3.5455925550074053`*^9}, {3.5455926015699053`*^9, 
   3.5455926132261553`*^9}, {3.5455927066480303`*^9, 3.5455927080542803`*^9}, 
   3.573082740515625*^9, 3.5732277132899575`*^9, {3.5732302458837075`*^9, 
   3.573230248149333*^9}, {3.5732302890712075`*^9, 3.5732302929774575`*^9}, {
   3.573604084421875*^9, 3.573604085953125*^9}, {3.573604270015625*^9, 
   3.57360427015625*^9}, {3.57360466609375*^9, 3.57360466734375*^9}, {
   3.57360474040625*^9, 3.573604770015625*^9}, {3.5736048081875*^9, 
   3.573604837453125*^9}, {3.5736048741875*^9, 3.573604877359375*^9}, {
   3.573604925453125*^9, 3.573604966203125*^9}, 3.5736050143125*^9, {
   3.57360506625*^9, 3.5736051148125*^9}, {3.57360536071875*^9, 
   3.57360538871875*^9}, {3.573605418765625*^9, 3.573605462984375*^9}, {
   3.5736072458125*^9, 3.573607279171875*^9}, {3.57360765978125*^9, 
   3.573607689046875*^9}, {3.57360774115625*^9, 3.57360778240625*^9}, {
   3.573607830125*^9, 3.573607886203125*^9}, {3.573607942578125*^9, 
   3.5736080731875*^9}, {3.573608109109375*^9, 3.57360811103125*^9}, {
   3.573608426203125*^9, 3.57360843815625*^9}, {3.573608991609375*^9, 
   3.573608994609375*^9}, {3.5736091794375*^9, 3.57360918290625*^9}, {
   3.5736103273125*^9, 3.57361032975*^9}, {3.573610990703125*^9, 
   3.5736109938125*^9}, {3.57361160325*^9, 3.573611763875*^9}, {
   3.57361187559375*^9, 3.573611887*^9}, 3.573612012203125*^9, {
   3.573612079703125*^9, 3.573612095234375*^9}, 3.573612193953125*^9, {
   3.573612258890625*^9, 3.573612260984375*^9}, 3.573612333375*^9, {
   3.573612364546875*^9, 3.57361237578125*^9}, {3.57365356240625*^9, 
   3.5736535755*^9}, {3.57365362378125*^9, 3.573653629796875*^9}, {
   3.573653795546875*^9, 3.573653853953125*^9}, {3.573696443296875*^9, 
   3.57369644825*^9}, {3.573696482328125*^9, 3.573696491546875*^9}, {
   3.573696582484375*^9, 3.573696627*^9}, {3.573696703375*^9, 
   3.57369670578125*^9}, {3.573759268859375*^9, 3.573759271109375*^9}, {
   3.573759345078125*^9, 3.573759345453125*^9}, {3.57375949871875*^9, 
   3.57375949915625*^9}, {3.5737608104375*^9, 3.573760821890625*^9}, 
   3.573776974890625*^9, {3.573788186390625*^9, 3.573788188125*^9}, {
   3.573788276375*^9, 3.573788276984375*^9}, {3.57378904734375*^9, 
   3.57378915725*^9}, {3.573789231546875*^9, 3.57378926384375*^9}, {
   3.573789331625*^9, 3.57378935925*^9}, {3.573789393703125*^9, 
   3.57378945953125*^9}, {3.573789744953125*^9, 3.57378977709375*^9}, {
   3.5737907164375*^9, 3.573790775203125*^9}, {3.57379083196875*^9, 
   3.573790835328125*^9}, 3.57395341896875*^9, {3.573953829265625*^9, 
   3.573953870625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Unimodal", " ", "convex", " ", "separable", " ", "function"}], 
    ";", " ", 
    RowBox[{"minimum", " ", "at", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "1", ",", " ", "..."}], "}"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "NelderMeadMinimize`Dump`Hyperellipsoid", "=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", "=", 
         RowBox[{"{", "##", "}"}]}], "}"}], ",", 
       RowBox[{"Plus", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Range", "@", 
           RowBox[{"Length", "[", "x", "]"}]}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "-", "1"}], ")"}], "^", "2"}]}], ")"}]}]}], "]"}], 
     "&"}]}], ";"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.544637036046875*^9, 3.544637052484375*^9}, {
   3.54463715625*^9, 3.5446371685625*^9}, {3.544637421921875*^9, 
   3.5446374619375*^9}, {3.544640607078125*^9, 3.544640633421875*^9}, {
   3.544640734671875*^9, 3.544640741359375*^9}, {3.544640779390625*^9, 
   3.5446408146875*^9}, {3.544641007796875*^9, 3.54464100834375*^9}, 
   3.5446534856875*^9, 3.57395406103125*^9, {3.5739555790625*^9, 
   3.573955580359375*^9}, {3.57395939778125*^9, 3.573959398609375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Unimodal", " ", "convex", " ", "nonseparable", " ", "function"}],
     ";", " ", 
    RowBox[{"minimum", " ", "at", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "1", ",", " ", "..."}], "}"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "NelderMeadMinimize`Dump`RotatedHyperellipsoid", "=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", "=", 
         RowBox[{"{", "##", "}"}]}], "}"}], ",", 
       RowBox[{"Plus", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FoldList", "[", 
           RowBox[{"Plus", ",", "0", ",", 
            RowBox[{"x", "-", "1"}]}], "]"}], "^", "2"}], ")"}]}]}], "]"}], 
     "&"}]}], ";"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.573955599546875*^9, 3.57395940365625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Non", "-", 
     RowBox[{"convex", " ", "function"}]}], ";", " ", 
    RowBox[{"global", " ", "minimum", " ", "at", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "1", ",", " ", "..."}], "}"}], " ", "with", " ", 
     "secondary", " ", "local", " ", "minimum", " ", "near", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", " ", "1", ",", " ", "1", ",", " ", "..."}], 
      "}"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NelderMeadMinimize`Dump`Rosenbrock", "=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "=", 
          RowBox[{"Most", "[", 
           RowBox[{"{", "##", "}"}], "]"}]}], ",", 
         RowBox[{"y", "=", 
          RowBox[{"Rest", "[", 
           RowBox[{"{", "##", "}"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"Plus", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"100", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"y", "-", 
              SuperscriptBox["x", "2"]}], ")"}], "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "x"}], ")"}], "2"]}], ")"}]}]}], "]"}], "&"}]}],
    ";"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.54463759328125*^9, 3.5446376560625*^9}, {
   3.544640404234375*^9, 3.544640454*^9}, {3.544640504265625*^9, 
   3.5446405055*^9}, {3.544640744625*^9, 3.5446407573125*^9}, {
   3.5446408046875*^9, 3.544640879609375*^9}, {3.5446410019375*^9, 
   3.544641028109375*^9}, 3.5446534856875*^9, 3.573954062234375*^9, 
   3.573959406140625*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.544465049046875*^9, 3.544465050390625*^9}, 
   3.5446534856875*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.5444642101875*^9, 3.544464218125*^9}, 
   3.5446534856875*^9}]
}, Open  ]],

Cell[TextData[{
 "Here we test the performance of our Nelder-Mead minimizer against that of ",
 StyleBox["NMinimize", "Input"],
 " for the hyperellipsoid function:"
}], "Text",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.54464877378125*^9, 3.544648802421875*^9}, {
  3.544648839734375*^9, 3.544648887390625*^9}},
 FontSize->16],

Cell[BoxData[
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"Unique", "[", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{"x", ",", "20"}], "]"}], ",", "Temporary"}], "]"}]}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.573610757734375*^9, 3.5736107858125*^9}, {
  3.57377626478125*^9, 3.5737762725*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Test", " ", "with", " ", "20"}], "-", 
    RowBox[{
    "dimensional", " ", "function", " ", "to", " ", "verify", " ", "that", 
     " ", "the", " ", "minimum", " ", "is", " ", "correctly", " ", 
     RowBox[{"found", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vars", "=", "vars"}], ",", 
      RowBox[{"dim", ":=", "NelderMeadMinimize`Private`dimension"}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"NelderMeadMinimize", "[", "\[IndentingNewLine]", 
       RowBox[{
       "NelderMeadMinimize`Dump`Hyperellipsoid", ",", "vars", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<InitialPoints\>\"", "\[RuleDelayed]", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"dim", "+", "1"}], ",", "dim"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Diagnostics\>\"", "\[Rule]", "True"}]}], 
       "\[IndentingNewLine]", "]"}], "//", "Print"}], ";", 
     "\[IndentingNewLine]", "NelderMeadMinimize`Dump`OperationCounts"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.573775861359375*^9, 3.57377595665625*^9}, {
   3.5737759943125*^9, 3.573776036203125*^9}, 3.573776278609375*^9, {
   3.573776339296875*^9, 3.5737763525*^9}, {3.573776796953125*^9, 
   3.573776802375*^9}, {3.573777689640625*^9, 3.57377769365625*^9}, {
   3.573777777375*^9, 3.573777889546875*^9}, {3.573795234734375*^9, 
   3.573795257*^9}, {3.574102184484375*^9, 3.5741021854375*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.1547868112435872`*^-13", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x$827", "\[Rule]", "1.0000001239157776`"}], ",", 
     RowBox[{"x$828", "\[Rule]", "1.0000000480641127`"}], ",", 
     RowBox[{"x$829", "\[Rule]", "0.999999984624651`"}], ",", 
     RowBox[{"x$830", "\[Rule]", "1.0000000547234231`"}], ",", 
     RowBox[{"x$831", "\[Rule]", "0.9999999681005202`"}], ",", 
     RowBox[{"x$832", "\[Rule]", "0.9999999921449236`"}], ",", 
     RowBox[{"x$833", "\[Rule]", "1.0000000047677795`"}], ",", 
     RowBox[{"x$834", "\[Rule]", "0.9999999866692955`"}], ",", 
     RowBox[{"x$835", "\[Rule]", "1.0000000532772841`"}], ",", 
     RowBox[{"x$836", "\[Rule]", "1.0000000052358953`"}], ",", 
     RowBox[{"x$837", "\[Rule]", "1.0000000032452485`"}], ",", 
     RowBox[{"x$838", "\[Rule]", "1.0000000340759319`"}], ",", 
     RowBox[{"x$839", "\[Rule]", "1.000000001704699`"}], ",", 
     RowBox[{"x$840", "\[Rule]", "1.000000010556922`"}], ",", 
     RowBox[{"x$841", "\[Rule]", "0.9999999795025041`"}], ",", 
     RowBox[{"x$842", "\[Rule]", "0.9999999890880601`"}], ",", 
     RowBox[{"x$843", "\[Rule]", "1.0000000358995342`"}], ",", 
     RowBox[{"x$844", "\[Rule]", "0.9999999963378894`"}], ",", 
     RowBox[{"x$845", "\[Rule]", "1.000000006143384`"}], ",", 
     RowBox[{"x$846", "\[Rule]", "0.9999999872853953`"}]}], "}"}]}], 
  "}"}]], "Print",
 CellChangeTimes->{{3.573777811140625*^9, 3.573777917234375*^9}, 
   3.57378107809375*^9, 3.5737814580625*^9, 3.57395419625*^9, 
   3.57425297746875*^9, 3.57425794275*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"Function evaluations\"\>", "\[Rule]", "17343"}], ",", 
   RowBox[{"\<\"Reflections\"\>", "\[Rule]", "12452"}], ",", 
   RowBox[{"\<\"Expansions\"\>", "\[Rule]", "414"}], ",", 
   RowBox[{"\<\"Contractions\"\>", "\[Rule]", "937"}], ",", 
   RowBox[{"\<\"Shrinkages\"\>", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5737763544375*^9, 3.573776360609375*^9}, {
   3.573776804734375*^9, 3.5737768085*^9}, {3.573776981296875*^9, 
   3.573776990453125*^9}, 3.573777156578125*^9, {3.573777770703125*^9, 
   3.573777917234375*^9}, 3.573781078109375*^9, 3.573781458078125*^9, 
   3.57395419625*^9, 3.57425297746875*^9, 3.57425794275*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{"(*", " ", 
    RowBox[{"NMinimize", " ", 
     RowBox[{"timing", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NMinimize", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"1", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "-", "1"}], ")"}], "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y", "-", "1"}], ")"}], "2"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<NelderMead\>\"", ",", 
         RowBox[{"\"\<PostProcess\>\"", "\[Rule]", "False"}]}], "}"}]}]}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "250", "}"}]}], "\[IndentingNewLine]", "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.544318994515625*^9, 3.5443190233125*^9}, {
   3.544319159234375*^9, 3.544319163515625*^9}, {3.544319850453125*^9, 
   3.544319886953125*^9}, {3.5443202498125*^9, 3.54432025390625*^9}, {
   3.544320355109375*^9, 3.54432036084375*^9}, {3.54432040078125*^9, 
   3.544320406828125*^9}, {3.54432043946875*^9, 3.544320441953125*^9}, 
   3.54432395475*^9, {3.544324287234375*^9, 3.54432429059375*^9}, {
   3.54432435196875*^9, 3.54432436553125*^9}, {3.54432528584375*^9, 
   3.54432529621875*^9}, {3.54432537715625*^9, 3.544325390703125*^9}, {
   3.54432552309375*^9, 3.5443255463125*^9}, {3.544356476569239*^9, 
   3.544356497256739*^9}, {3.5443576778661137`*^9, 3.544357681756739*^9}, {
   3.544359333537989*^9, 3.544359343037989*^9}, {3.5443594063973637`*^9, 
   3.5443594383348637`*^9}, {3.5443598535536137`*^9, 3.544359873506739*^9}, 
   3.5443599337098637`*^9, {3.5443599914286137`*^9, 3.544359994412989*^9}, {
   3.5443601353036137`*^9, 3.5443601360536137`*^9}, {3.544644692*^9, 
   3.54464472165625*^9}, 3.544644799546875*^9, {3.54464486459375*^9, 
   3.5446448813125*^9}, {3.544645798796875*^9, 3.544645836171875*^9}, {
   3.5446460345*^9, 3.54464604115625*^9}, {3.54464741625*^9, 
   3.5446474245*^9}, {3.544647690578125*^9, 3.54464772296875*^9}, {
   3.544647776125*^9, 3.54464778375*^9}, {3.544647980359375*^9, 
   3.544647994765625*^9}, 3.544648487484375*^9, 3.544648526625*^9, {
   3.54464859971875*^9, 3.544648632953125*^9}, {3.544649074578125*^9, 
   3.54464907953125*^9}, {3.544649175609375*^9, 3.5446491780625*^9}, {
   3.544649282171875*^9, 3.5446492825*^9}, {3.573777245171875*^9, 
   3.573777273140625*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.140625`6.7316158372457116", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.544648477453125*^9, {3.544648525078125*^9, 3.544648552421875*^9}, {
   3.544648602453125*^9, 3.5446486415625*^9}, 3.54464922871875*^9, 
   3.544649287890625*^9, 3.54465206390625*^9, 3.544668363796875*^9, 
   3.544668516765625*^9, 3.54466915075*^9, 3.544671303265625*^9, 
   3.544676065078125*^9, 3.544739669015625*^9, 3.544751308484375*^9, 
   3.54524450403125*^9, 3.54524648971875*^9, 3.545249459171875*^9, 
   3.545250131125*^9, 3.54526582459375*^9, 3.545272879984375*^9, 
   3.545273721125*^9, 3.545274170328125*^9, 3.5730807555625*^9, 
   3.573082370546875*^9, 3.57308306865625*^9, 3.573083109296875*^9, 
   3.57308632121875*^9, 3.57308637953125*^9, 3.573086434390625*^9, 
   3.573090165359375*^9, 3.573090227453125*^9, 3.573111060140625*^9, 
   3.5731115800625*^9, 3.57311163259375*^9, 3.5731133250625*^9, 
   3.573113379625*^9, 3.5732584638212075`*^9, 3.573258537211833*^9, 
   3.573258596430583*^9, 3.5736110628125*^9, 3.573612698484375*^9, 
   3.573777168109375*^9, {3.573781087078125*^9, 3.573781094734375*^9}, {
   3.574252988265625*^9, 3.574253001671875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"NelderMeadMinimize", " ", "timing", " ", 
      RowBox[{"(", 
       RowBox[{"note", " ", "many", " ", "more", " ", "iterations"}], ")"}]}],
      ":"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NelderMeadMinimize", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"1", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x", "-", "1"}], ")"}], "2"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y", "-", "1"}], ")"}], "2"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", "10000", "}"}]}], "\[IndentingNewLine]", "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.544318994515625*^9, 3.5443190233125*^9}, {
   3.544319159234375*^9, 3.544319163515625*^9}, {3.544319850453125*^9, 
   3.544319886953125*^9}, {3.5443202498125*^9, 3.54432025390625*^9}, {
   3.544320355109375*^9, 3.54432036084375*^9}, {3.54432040078125*^9, 
   3.544320406828125*^9}, {3.54432043946875*^9, 3.544320441953125*^9}, 
   3.54432395475*^9, {3.544324287234375*^9, 3.54432429059375*^9}, {
   3.54432435196875*^9, 3.54432436553125*^9}, {3.54432528584375*^9, 
   3.54432529621875*^9}, {3.54432537715625*^9, 3.544325390703125*^9}, {
   3.54432552309375*^9, 3.5443255463125*^9}, {3.544356476569239*^9, 
   3.544356497256739*^9}, {3.5443576778661137`*^9, 3.544357681756739*^9}, {
   3.544359333537989*^9, 3.544359343037989*^9}, {3.5443594063973637`*^9, 
   3.5443594383348637`*^9}, {3.5443598535536137`*^9, 3.544359873506739*^9}, 
   3.5443599337098637`*^9, {3.5443599914286137`*^9, 3.544359994412989*^9}, {
   3.5443601353036137`*^9, 3.5443601360536137`*^9}, {3.544644692*^9, 
   3.54464472165625*^9}, 3.544644799546875*^9, {3.54464486459375*^9, 
   3.5446448813125*^9}, {3.544645798796875*^9, 3.544645836171875*^9}, {
   3.5446460345*^9, 3.54464604115625*^9}, {3.54464741625*^9, 
   3.5446474245*^9}, {3.544647690578125*^9, 3.54464772296875*^9}, {
   3.544647776125*^9, 3.54464778375*^9}, {3.544647980359375*^9, 
   3.544647994765625*^9}, {3.54464908646875*^9, 3.5446490874375*^9}, {
   3.544649171140625*^9, 3.544649191234375*^9}, 3.5737772814375*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4.265625`6.650582586336492", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.544644800046875*^9, {3.544644853015625*^9, 3.54464488190625*^9}, 
   3.544644950296875*^9, 3.54464504103125*^9, 3.544645132703125*^9, 
   3.544645170125*^9, 3.544645206890625*^9, 3.544645246421875*^9, 
   3.54464535309375*^9, 3.544645591828125*^9, {3.544645801515625*^9, 
   3.54464584346875*^9}, 3.54464587921875*^9, {3.544646036109375*^9, 
   3.544646041375*^9}, 3.5446473859375*^9, 3.544647425703125*^9, {
   3.544647546375*^9, 3.544647549828125*^9}, {3.544647603625*^9, 
   3.544647638765625*^9}, {3.544647683859375*^9, 3.54464773665625*^9}, {
   3.544647781671875*^9, 3.54464782065625*^9}, {3.544647894453125*^9, 
   3.544647903328125*^9}, 3.544647938625*^9, 3.544647988953125*^9, 
   3.54464857471875*^9, 3.544649234859375*^9, 3.544652069984375*^9, 
   3.5446685225625*^9, 3.54466915640625*^9, 3.54467130915625*^9, 
   3.54467607090625*^9, 3.54473967484375*^9, 3.544751314578125*^9, 
   3.545244511796875*^9, 3.545246495296875*^9, 3.545249464796875*^9, 
   3.54525013678125*^9, 3.54526583071875*^9, 3.545265933140625*^9, 
   3.545272887109375*^9, 3.5452737266875*^9, 3.545274175890625*^9, 
   3.545274206921875*^9, {3.5455888823667803`*^9, 3.5455888891636553`*^9}, 
   3.57308076421875*^9, 3.573082376125*^9, 3.573083074046875*^9, 
   3.573083113625*^9, 3.573083206546875*^9, 3.573086327265625*^9, 
   3.573086384765625*^9, 3.573086438671875*^9, 3.573090170828125*^9, 
   3.57309023171875*^9, 3.5731110685*^9, 3.573111585890625*^9, 
   3.573111636921875*^9, 3.57311333034375*^9, 3.573113383859375*^9, 
   3.5732584699774575`*^9, 3.5732585423212075`*^9, 3.5732586016024575`*^9, {
   3.5736110708125*^9, 3.573611092828125*^9}, 3.5736127045*^9, {
   3.573613012203125*^9, 3.57361301809375*^9}, {3.57377717434375*^9, 
   3.573777192625*^9}, {3.57377729415625*^9, 3.573777307859375*^9}, {
   3.573781103765625*^9, 3.573781109328125*^9}, {3.574253009328125*^9, 
   3.5742530156875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Timing", " ", "when", " ", "calling", " ", 
     "NelderMeadMinimize`Dump`CompiledNelderMead", " ", 
     RowBox[{"directly", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "NelderMeadMinimize`Dump`CompiledNelderMead", "[", "\[IndentingNewLine]", 
      RowBox[{"NelderMeadMinimize`Dump`Hyperellipsoid", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "\"\<ReturnValues\>\"", "\[Rule]", 
        "\"\<AugmentedOptimizedParameters\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], 
      "\[IndentingNewLine]", "]"}], "[", 
     RowBox[{
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "2"}], "}"}]}], "]"}], ",", "$MachineEpsilon", ",", 
      RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "10000", "}"}]}], "\[IndentingNewLine]", "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.544360607819239*^9, 3.5443606226786137`*^9}, {
   3.5443606670223637`*^9, 3.544360675194239*^9}, {3.544360740631739*^9, 
   3.5443607448036137`*^9}, 3.5443610592098637`*^9, {3.5443611706473637`*^9, 
   3.5443611722723637`*^9}, {3.544361980256739*^9, 3.544361985694239*^9}, {
   3.5443633573661137`*^9, 3.544363357694239*^9}, {3.544364714662989*^9, 
   3.544364744725489*^9}, {3.5443649967723637`*^9, 3.544365003912989*^9}, 
   3.544365224850489*^9, 3.544365902444239*^9, 3.544366186350489*^9, 
   3.5443665512098637`*^9, {3.544367201350489*^9, 3.5443672178973637`*^9}, {
   3.544367331194239*^9, 3.544367500506739*^9}, {3.5443675580223637`*^9, 
   3.544367566037989*^9}, {3.544367611756739*^9, 3.5443676434911137`*^9}, {
   3.544367797037989*^9, 3.544367926506739*^9}, {3.544367974787989*^9, 
   3.544367987319239*^9}, 3.544368019975489*^9, {3.5443683550536137`*^9, 
   3.5443685003973637`*^9}, {3.544368542069239*^9, 3.5443686471473637`*^9}, {
   3.544368950006739*^9, 3.544368966225489*^9}, {3.5443733181161137`*^9, 
   3.5443733305223637`*^9}, {3.544375214912989*^9, 3.544375226162989*^9}, {
   3.5443756486161137`*^9, 3.5443756864598637`*^9}, {3.5443767190536137`*^9, 
   3.544376720287989*^9}, {3.5443793777723637`*^9, 3.544379379256739*^9}, {
   3.5443798619911137`*^9, 3.5443798712411137`*^9}, 3.5443825935848637`*^9, 
   3.544382742100489*^9, {3.544382781256739*^9, 3.5443828063973637`*^9}, {
   3.5443829558348637`*^9, 3.544382956100489*^9}, {3.544383038225489*^9, 
   3.5443830407723637`*^9}, {3.544383651194239*^9, 3.544383669444239*^9}, 
   3.5443837783036137`*^9, 3.5443838384911137`*^9, {3.544383875600489*^9, 
   3.544383875694239*^9}, {3.5443839535536137`*^9, 3.5443839592098637`*^9}, 
   3.544383992787989*^9, {3.5443840798036137`*^9, 3.5443840811786137`*^9}, {
   3.544384533975489*^9, 3.544384553912989*^9}, {3.544384587444239*^9, 
   3.5443846928036137`*^9}, {3.544384736037989*^9, 3.544385041975489*^9}, {
   3.5443851717098637`*^9, 3.5443852398973637`*^9}, 3.5443853169598637`*^9, {
   3.5443853759286137`*^9, 3.544385386850489*^9}, {3.544385419944239*^9, 
   3.544385421131739*^9}, {3.544385451350489*^9, 3.5443855023661137`*^9}, {
   3.544385539256739*^9, 3.5443855416161137`*^9}, {3.544385602662989*^9, 
   3.5443856029598637`*^9}, {3.544385841444239*^9, 3.544385955319239*^9}, {
   3.5443859972411137`*^9, 3.544386100569239*^9}, 3.5443861345223637`*^9, {
   3.5443861962411137`*^9, 3.544386196537989*^9}, {3.5443862885223637`*^9, 
   3.5443862916786137`*^9}, {3.5443863217098637`*^9, 
   3.5443863266473637`*^9}, {3.5443868274911137`*^9, 
   3.5443868368036137`*^9}, {3.5443873716161137`*^9, 
   3.5443874322723637`*^9}, {3.5443877039911137`*^9, 
   3.5443877118661137`*^9}, {3.5443880160536137`*^9, 3.544388019256739*^9}, {
   3.5443882435848637`*^9, 3.5443882450536137`*^9}, {3.544393166506739*^9, 
   3.544393171287989*^9}, {3.5443986931786137`*^9, 3.5443986937723637`*^9}, {
   3.5443990741161137`*^9, 3.544399098037989*^9}, {3.5443995450536137`*^9, 
   3.5443995586786137`*^9}, {3.5443998348036137`*^9, 3.544399895381739*^9}, {
   3.544399933037989*^9, 3.544399957944239*^9}, {3.5444000970223637`*^9, 
   3.544400100006739*^9}, 3.544405247975489*^9, 3.544463292609375*^9, 
   3.544464304203125*^9, 3.544465551671875*^9, {3.544466984671875*^9, 
   3.544466986515625*^9}, {3.544467329671875*^9, 3.54446746084375*^9}, {
   3.5444675028125*^9, 3.544467503359375*^9}, {3.544467697890625*^9, 
   3.54446772096875*^9}, {3.5444684258125*^9, 3.544468427171875*^9}, {
   3.54447965659375*^9, 3.5444796575*^9}, 3.544480462890625*^9, {
   3.544637223640625*^9, 3.544637225453125*^9}, {3.544641127375*^9, 
   3.54464112759375*^9}, {3.5446411765625*^9, 3.544641176796875*^9}, 
   3.544641217296875*^9, {3.54464746221875*^9, 3.544647539234375*^9}, {
   3.544647630921875*^9, 3.544647691484375*^9}, {3.544647741890625*^9, 
   3.54464776496875*^9}, 3.544647925640625*^9, 3.544647969515625*^9, {
   3.544649095515625*^9, 3.544649120234375*^9}, {3.544649166484375*^9, 
   3.544649197609375*^9}, {3.545273922953125*^9, 3.54527392815625*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.53125`6.568528378443138", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.54464754034375*^9, 3.544647550921875*^9}, {
   3.54464760515625*^9, 3.544647643390625*^9}, {3.54464767928125*^9, 
   3.544647698609375*^9}, {3.5446477475*^9, 3.544647772484375*^9}, 
   3.5446478289375*^9, {3.5446479261875*^9, 3.5446479763125*^9}, 
   3.5446485844375*^9, 3.54464923975*^9, 3.544652074890625*^9, 
   3.544668527390625*^9, 3.54466916121875*^9, 3.544671313921875*^9, 
   3.544676075625*^9, 3.544739679609375*^9, 3.5447513195*^9, 3.54524451675*^9,
    3.5452465000625*^9, 3.545249469578125*^9, 3.545250141609375*^9, 
   3.545265835671875*^9, 3.545265946953125*^9, 3.545272892015625*^9, 
   3.54527373159375*^9, 3.545274180390625*^9, 3.54527421234375*^9, {
   3.5455888955699053`*^9, 3.5455889015386553`*^9}, 3.573080768453125*^9, 
   3.5730823805*^9, 3.573083078265625*^9, 3.57308311690625*^9, 
   3.573083211453125*^9, 3.573086331703125*^9, 3.57308638896875*^9, 
   3.573086441953125*^9, 3.573090175140625*^9, 3.573090235*^9, 
   3.573111072984375*^9, 3.57311159015625*^9, 3.573111640171875*^9, 
   3.573113334609375*^9, 3.573113387109375*^9, 3.5732584752899575`*^9, 
   3.5732585465087075`*^9, 3.573258605743083*^9, {3.573611078296875*^9, 
   3.573611085234375*^9}, 3.5736127095*^9, {3.573613023484375*^9, 
   3.57361303571875*^9}, {3.57377717946875*^9, 3.57377719825*^9}, {
   3.57377731590625*^9, 3.573777321703125*^9}, {3.573781115578125*^9, 
   3.573781119796875*^9}, {3.574253022265625*^9, 3.574253042796875*^9}}]
}, Open  ]],

Cell["\<\
Now we try with Rosenbrock\[CloseCurlyQuote]s function:\
\>", "Text",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.54464877378125*^9, 3.544648802421875*^9}, {
  3.544648839734375*^9, 3.544648890578125*^9}, {3.54464895653125*^9, 
  3.54464895696875*^9}},
 FontSize->16],

Cell[BoxData[
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"Unique", "[", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{"x", ",", "20"}], "]"}], ",", "Temporary"}], "]"}]}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.573610757734375*^9, 3.5736107858125*^9}, 
   3.573776384046875*^9, {3.57377648790625*^9, 3.5737765085*^9}, {
   3.573776833515625*^9, 3.57377690821875*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Test", " ", "with", " ", "20"}], "-", 
    RowBox[{
    "dimensional", " ", "function", " ", "to", " ", "verify", " ", "that", 
     " ", "the", " ", "minimum", " ", "is", " ", "correctly", " ", 
     RowBox[{"found", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"vars", "=", "vars"}], ",", 
      RowBox[{"dim", ":=", "NelderMeadMinimize`Private`dimension"}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"NelderMeadMinimize", "[", "\[IndentingNewLine]", 
       RowBox[{
       "NelderMeadMinimize`Dump`Rosenbrock", ",", "vars", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<InitialPoints\>\"", "\[RuleDelayed]", 
         RowBox[{"RandomReal", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"dim", "+", "1"}], ",", "dim"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Diagnostics\>\"", "\[Rule]", "True"}]}], 
       "\[IndentingNewLine]", "]"}], "//", "Print"}], ";", 
     "\[IndentingNewLine]", "NelderMeadMinimize`Dump`OperationCounts"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.573775861359375*^9, 3.57377595665625*^9}, {
   3.5737759943125*^9, 3.573776036203125*^9}, 3.573776278609375*^9, {
   3.573776339296875*^9, 3.5737763525*^9}, {3.57377638803125*^9, 
   3.57377638934375*^9}, {3.573776816390625*^9, 3.573776823296875*^9}, 
   3.573795277328125*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9.21975717121478`*^-15", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x$827", "\[Rule]", "0.9999999982682917`"}], ",", 
     RowBox[{"x$828", "\[Rule]", "0.9999999995965667`"}], ",", 
     RowBox[{"x$829", "\[Rule]", "1.0000000008801047`"}], ",", 
     RowBox[{"x$830", "\[Rule]", "1.00000000085686`"}], ",", 
     RowBox[{"x$831", "\[Rule]", "1.000000000965188`"}], ",", 
     RowBox[{"x$832", "\[Rule]", "1.0000000020495925`"}], ",", 
     RowBox[{"x$833", "\[Rule]", "1.0000000022693514`"}], ",", 
     RowBox[{"x$834", "\[Rule]", "1.0000000020738722`"}], ",", 
     RowBox[{"x$835", "\[Rule]", "1.0000000007399157`"}], ",", 
     RowBox[{"x$836", "\[Rule]", "1.0000000001710898`"}], ",", 
     RowBox[{"x$837", "\[Rule]", "0.9999999994692792`"}], ",", 
     RowBox[{"x$838", "\[Rule]", "0.9999999980621541`"}], ",", 
     RowBox[{"x$839", "\[Rule]", "0.9999999981941196`"}], ",", 
     RowBox[{"x$840", "\[Rule]", "0.9999999980760227`"}], ",", 
     RowBox[{"x$841", "\[Rule]", "0.9999999999923461`"}], ",", 
     RowBox[{"x$842", "\[Rule]", "1.0000000023778868`"}], ",", 
     RowBox[{"x$843", "\[Rule]", "1.000000003882262`"}], ",", 
     RowBox[{"x$844", "\[Rule]", "1.0000000098978`"}], ",", 
     RowBox[{"x$845", "\[Rule]", "1.0000000215608016`"}], ",", 
     RowBox[{"x$846", "\[Rule]", "1.0000000396379176`"}]}], "}"}]}], 
  "}"}]], "Print",
 CellChangeTimes->{
  3.573776395203125*^9, {3.5737764838125*^9, 3.573776511375*^9}, {
   3.573776826109375*^9, 3.5737769115625*^9}, 3.57377700028125*^9, 
   3.57377720875*^9, 3.57377736753125*^9, 3.573777932390625*^9, 
   3.57378112896875*^9, 3.573781471015625*^9, 3.5739542163125*^9, 
   3.574253064109375*^9, 3.57425794859375*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"Function evaluations\"\>", "\[Rule]", "96646"}], ",", 
   RowBox[{"\<\"Reflections\"\>", "\[Rule]", "70214"}], ",", 
   RowBox[{"\<\"Expansions\"\>", "\[Rule]", "3269"}], ",", 
   RowBox[{"\<\"Contractions\"\>", "\[Rule]", "3847"}], ",", 
   RowBox[{"\<\"Shrinkages\"\>", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.573776395203125*^9, {3.5737764838125*^9, 3.573776511375*^9}, {
   3.573776826125*^9, 3.5737769115625*^9}, 3.57377700028125*^9, 
   3.57377720875*^9, 3.57377736753125*^9, 3.573777932390625*^9, 
   3.57378112896875*^9, 3.57378147103125*^9, 3.5739542163125*^9, 
   3.574253064125*^9, 3.57425794859375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{"(*", " ", 
    RowBox[{"NMinimize", " ", 
     RowBox[{"timing", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NMinimize", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"100", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y", "-", 
           SuperscriptBox["x", "2"]}], ")"}], "2"]}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "x"}], ")"}], "2"]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<NelderMead\>\"", ",", 
         RowBox[{"\"\<PostProcess\>\"", "\[Rule]", "False"}]}], "}"}]}]}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "250", "}"}]}], "\[IndentingNewLine]", "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.544318994515625*^9, 3.5443190233125*^9}, {
   3.544319159234375*^9, 3.544319163515625*^9}, {3.544319850453125*^9, 
   3.544319886953125*^9}, {3.5443202498125*^9, 3.54432025390625*^9}, {
   3.544320355109375*^9, 3.54432036084375*^9}, {3.54432040078125*^9, 
   3.544320406828125*^9}, {3.54432043946875*^9, 3.544320441953125*^9}, 
   3.54432395475*^9, {3.544324287234375*^9, 3.54432429059375*^9}, {
   3.54432435196875*^9, 3.54432436553125*^9}, {3.54432528584375*^9, 
   3.54432529621875*^9}, {3.54432537715625*^9, 3.544325390703125*^9}, {
   3.54432552309375*^9, 3.5443255463125*^9}, {3.544356476569239*^9, 
   3.544356497256739*^9}, {3.5443576778661137`*^9, 3.544357681756739*^9}, {
   3.544359333537989*^9, 3.544359343037989*^9}, {3.5443594063973637`*^9, 
   3.5443594383348637`*^9}, {3.5443598535536137`*^9, 3.544359873506739*^9}, 
   3.5443599337098637`*^9, {3.5443599914286137`*^9, 3.544359994412989*^9}, {
   3.5443601353036137`*^9, 3.5443601360536137`*^9}, {3.544644692*^9, 
   3.54464472165625*^9}, 3.544644799546875*^9, {3.54464486459375*^9, 
   3.5446448813125*^9}, {3.544645798796875*^9, 3.544645836171875*^9}, {
   3.5446460345*^9, 3.54464604115625*^9}, {3.54464741625*^9, 
   3.5446474245*^9}, {3.544647690578125*^9, 3.54464772296875*^9}, {
   3.544647776125*^9, 3.54464778375*^9}, {3.544647980359375*^9, 
   3.544647994765625*^9}, 3.544648487484375*^9, 3.544648526625*^9, {
   3.54464859971875*^9, 3.544648632953125*^9}, 3.544648672875*^9, {
   3.544649002234375*^9, 3.54464903471875*^9}, {3.544649148734375*^9, 
   3.544649151109375*^9}, {3.544649268828125*^9, 3.544649269140625*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.109375`6.806596696691604", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.544648684734375*^9, {3.544649249484375*^9, 3.54464927559375*^9}, 
   3.544652081015625*^9, 3.544668533625*^9, 3.544669167453125*^9, 
   3.544671320234375*^9, 3.54467608196875*^9, 3.5447396859375*^9, 
   3.54475132615625*^9, 3.54524452315625*^9, 3.54524650621875*^9, 
   3.545249475921875*^9, 3.5452501479375*^9, 3.545265842109375*^9, 
   3.545265964203125*^9, 3.545272898234375*^9, 3.54527373784375*^9, 
   3.545274186625*^9, 3.5730807745625*^9, 3.57308238665625*^9, 
   3.57308308446875*^9, 3.573083123046875*^9, 3.573086337921875*^9, 
   3.573086395125*^9, 3.573086448109375*^9, 3.5730901813125*^9, 
   3.573090241109375*^9, 3.57311107921875*^9, 3.57311159621875*^9, 
   3.57311164628125*^9, 3.5731133406875*^9, 3.57311339321875*^9, 
   3.5732584813524575`*^9, 3.5732585528524575`*^9, 3.573258611836833*^9, 
   3.5736111051875*^9, 3.573612715578125*^9, {3.57377737628125*^9, 
   3.57377739140625*^9}, {3.5737811565*^9, 3.573781164625*^9}, {
   3.574253074*^9, 3.574253091515625*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"NelderMeadMinimize", " ", "timing", " ", 
      RowBox[{"(", 
       RowBox[{"note", " ", "many", " ", "more", " ", "iterations"}], ")"}]}],
      ":"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NelderMeadMinimize", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"100", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"y", "-", 
           SuperscriptBox["x", "2"]}], ")"}], "2"]}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", "x"}], ")"}], "2"]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", "10000", "}"}]}], "\[IndentingNewLine]", "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.544318994515625*^9, 3.5443190233125*^9}, {
   3.544319159234375*^9, 3.544319163515625*^9}, {3.544319850453125*^9, 
   3.544319886953125*^9}, {3.5443202498125*^9, 3.54432025390625*^9}, {
   3.544320355109375*^9, 3.54432036084375*^9}, {3.54432040078125*^9, 
   3.544320406828125*^9}, {3.54432043946875*^9, 3.544320441953125*^9}, 
   3.54432395475*^9, {3.544324287234375*^9, 3.54432429059375*^9}, {
   3.54432435196875*^9, 3.54432436553125*^9}, {3.54432528584375*^9, 
   3.54432529621875*^9}, {3.54432537715625*^9, 3.544325390703125*^9}, {
   3.54432552309375*^9, 3.5443255463125*^9}, {3.544356476569239*^9, 
   3.544356497256739*^9}, {3.5443576778661137`*^9, 3.544357681756739*^9}, {
   3.544359333537989*^9, 3.544359343037989*^9}, {3.5443594063973637`*^9, 
   3.5443594383348637`*^9}, {3.5443598535536137`*^9, 3.544359873506739*^9}, 
   3.5443599337098637`*^9, {3.5443599914286137`*^9, 3.544359994412989*^9}, {
   3.5443601353036137`*^9, 3.5443601360536137`*^9}, {3.544644692*^9, 
   3.54464472165625*^9}, 3.544644799546875*^9, {3.54464486459375*^9, 
   3.5446448813125*^9}, {3.544645798796875*^9, 3.544645836171875*^9}, {
   3.5446460345*^9, 3.54464604115625*^9}, {3.54464741625*^9, 
   3.5446474245*^9}, {3.544647690578125*^9, 3.54464772296875*^9}, {
   3.544647776125*^9, 3.54464778375*^9}, 3.54464801196875*^9, {
   3.544649010765625*^9, 3.54464905175*^9}, {3.544649153671875*^9, 
   3.5446491555625*^9}, 3.5446492049375*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.515625`6.76219464468356", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5446480239375*^9, 3.544648711015625*^9, 3.544649256234375*^9, 
   3.544652087765625*^9, 3.5446685399375*^9, 3.54466917378125*^9, 
   3.5446713265625*^9, 3.544676088265625*^9, 3.544739692171875*^9, 
   3.54475133253125*^9, {3.54475147584375*^9, 3.5447514836875*^9}, 
   3.545244529578125*^9, 3.54524651246875*^9, 3.54524948225*^9, 
   3.545250154265625*^9, 3.545265848640625*^9, 3.54526598096875*^9, 
   3.54527290465625*^9, 3.54527374396875*^9, 3.545273830265625*^9, 
   3.54527386496875*^9, 3.54527419278125*^9, 3.545274228046875*^9, {
   3.5455889323042803`*^9, 3.5455889594292803`*^9}, 3.573080780671875*^9, 
   3.573082392359375*^9, 3.57308309028125*^9, 3.573083128078125*^9, {
   3.57308316928125*^9, 3.57308318825*^9}, 3.573086343921875*^9, 
   3.573086400875*^9, 3.57308645321875*^9, 3.573090187109375*^9, 
   3.57309024609375*^9, 3.57311108528125*^9, 3.573111601984375*^9, 
   3.573111651265625*^9, 3.573113346390625*^9, 3.573113398140625*^9, 
   3.5732584882587075`*^9, 3.5732585589149575`*^9, 3.573258617930583*^9, {
   3.57361111375*^9, 3.573611121765625*^9}, 3.573612722359375*^9, {
   3.57361281234375*^9, 3.573612866078125*^9}, {3.57377740125*^9, 
   3.573777470125*^9}, {3.5737811728125*^9, 3.573781179296875*^9}, {
   3.57378123259375*^9, 3.57378127365625*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Timing", " ", "when", " ", "calling", " ", 
     "NelderMeadMinimize`Dump`CompiledNelderMead", " ", 
     RowBox[{"directly", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "NelderMeadMinimize`Dump`CompiledNelderMead", "[", "\[IndentingNewLine]", 
      RowBox[{"NelderMeadMinimize`Dump`Rosenbrock", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
       "\"\<ReturnValues\>\"", "\[Rule]", 
        "\"\<AugmentedOptimizedParameters\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], 
      "\[IndentingNewLine]", "]"}], "[", 
     RowBox[{
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "2"}], "}"}]}], "]"}], ",", "$MachineEpsilon", ",", 
      RowBox[{"-", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "10000", "}"}]}], "\[IndentingNewLine]", "]"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.544360607819239*^9, 3.5443606226786137`*^9}, {
   3.5443606670223637`*^9, 3.544360675194239*^9}, {3.544360740631739*^9, 
   3.5443607448036137`*^9}, 3.5443610592098637`*^9, {3.5443611706473637`*^9, 
   3.5443611722723637`*^9}, {3.544361980256739*^9, 3.544361985694239*^9}, {
   3.5443633573661137`*^9, 3.544363357694239*^9}, {3.544364714662989*^9, 
   3.544364744725489*^9}, {3.5443649967723637`*^9, 3.544365003912989*^9}, 
   3.544365224850489*^9, 3.544365902444239*^9, 3.544366186350489*^9, 
   3.5443665512098637`*^9, {3.544367201350489*^9, 3.5443672178973637`*^9}, {
   3.544367331194239*^9, 3.544367500506739*^9}, {3.5443675580223637`*^9, 
   3.544367566037989*^9}, {3.544367611756739*^9, 3.5443676434911137`*^9}, {
   3.544367797037989*^9, 3.544367926506739*^9}, {3.544367974787989*^9, 
   3.544367987319239*^9}, 3.544368019975489*^9, {3.5443683550536137`*^9, 
   3.5443685003973637`*^9}, {3.544368542069239*^9, 3.5443686471473637`*^9}, {
   3.544368950006739*^9, 3.544368966225489*^9}, {3.5443733181161137`*^9, 
   3.5443733305223637`*^9}, {3.544375214912989*^9, 3.544375226162989*^9}, {
   3.5443756486161137`*^9, 3.5443756864598637`*^9}, {3.5443767190536137`*^9, 
   3.544376720287989*^9}, {3.5443793777723637`*^9, 3.544379379256739*^9}, {
   3.5443798619911137`*^9, 3.5443798712411137`*^9}, 3.5443825935848637`*^9, 
   3.544382742100489*^9, {3.544382781256739*^9, 3.5443828063973637`*^9}, {
   3.5443829558348637`*^9, 3.544382956100489*^9}, {3.544383038225489*^9, 
   3.5443830407723637`*^9}, {3.544383651194239*^9, 3.544383669444239*^9}, 
   3.5443837783036137`*^9, 3.5443838384911137`*^9, {3.544383875600489*^9, 
   3.544383875694239*^9}, {3.5443839535536137`*^9, 3.5443839592098637`*^9}, 
   3.544383992787989*^9, {3.5443840798036137`*^9, 3.5443840811786137`*^9}, {
   3.544384533975489*^9, 3.544384553912989*^9}, {3.544384587444239*^9, 
   3.5443846928036137`*^9}, {3.544384736037989*^9, 3.544385041975489*^9}, {
   3.5443851717098637`*^9, 3.5443852398973637`*^9}, 3.5443853169598637`*^9, {
   3.5443853759286137`*^9, 3.544385386850489*^9}, {3.544385419944239*^9, 
   3.544385421131739*^9}, {3.544385451350489*^9, 3.5443855023661137`*^9}, {
   3.544385539256739*^9, 3.5443855416161137`*^9}, {3.544385602662989*^9, 
   3.5443856029598637`*^9}, {3.544385841444239*^9, 3.544385955319239*^9}, {
   3.5443859972411137`*^9, 3.544386100569239*^9}, 3.5443861345223637`*^9, {
   3.5443861962411137`*^9, 3.544386196537989*^9}, {3.5443862885223637`*^9, 
   3.5443862916786137`*^9}, {3.5443863217098637`*^9, 
   3.5443863266473637`*^9}, {3.5443868274911137`*^9, 
   3.5443868368036137`*^9}, {3.5443873716161137`*^9, 
   3.5443874322723637`*^9}, {3.5443877039911137`*^9, 
   3.5443877118661137`*^9}, {3.5443880160536137`*^9, 3.544388019256739*^9}, {
   3.5443882435848637`*^9, 3.5443882450536137`*^9}, {3.544393166506739*^9, 
   3.544393171287989*^9}, {3.5443986931786137`*^9, 3.5443986937723637`*^9}, {
   3.5443990741161137`*^9, 3.544399098037989*^9}, {3.5443995450536137`*^9, 
   3.5443995586786137`*^9}, {3.5443998348036137`*^9, 3.544399895381739*^9}, {
   3.544399933037989*^9, 3.544399957944239*^9}, {3.5444000970223637`*^9, 
   3.544400100006739*^9}, 3.544405247975489*^9, 3.544463292609375*^9, 
   3.544464304203125*^9, 3.544465551671875*^9, {3.544466984671875*^9, 
   3.544466986515625*^9}, {3.544467329671875*^9, 3.54446746084375*^9}, {
   3.5444675028125*^9, 3.544467503359375*^9}, {3.544467697890625*^9, 
   3.54446772096875*^9}, {3.5444684258125*^9, 3.544468427171875*^9}, {
   3.54447965659375*^9, 3.5444796575*^9}, 3.544480462890625*^9, {
   3.544637223640625*^9, 3.544637225453125*^9}, {3.544641127375*^9, 
   3.54464112759375*^9}, {3.5446411765625*^9, 3.544641176796875*^9}, 
   3.544641217296875*^9, {3.54464746221875*^9, 3.544647539234375*^9}, {
   3.544647630921875*^9, 3.544647691484375*^9}, {3.544647741890625*^9, 
   3.54464776496875*^9}, 3.544648033078125*^9, {3.5446490253125*^9, 
   3.544649040015625*^9}, 3.54464912775*^9, {3.544649157859375*^9, 
   3.54464916*^9}, 3.544649210984375*^9, {3.545273874421875*^9, 
   3.545273900578125*^9}, {3.545273932671875*^9, 3.545273940546875*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.515625`6.76219464468356", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.544648042984375*^9, 3.54464873021875*^9, 3.544649262953125*^9, 
   3.544652095671875*^9, 3.544668546609375*^9, 3.544669180390625*^9, {
   3.5446713331875*^9, 3.544671348328125*^9}, 3.544676094875*^9, 
   3.54473969875*^9, {3.544739832984375*^9, 3.544739853390625*^9}, {
   3.544751339328125*^9, 3.544751504265625*^9}, 3.54524453634375*^9, 
   3.54524651903125*^9, 3.5452494889375*^9, 3.545250160890625*^9, 
   3.5452658555625*^9, 3.545265990234375*^9, 3.545272911375*^9, 
   3.545273750671875*^9, {3.545273838875*^9, 3.5452738573125*^9}, {
   3.54527389128125*^9, 3.5452739140625*^9}, 3.545274199140625*^9, {
   3.5452742356875*^9, 3.54527426053125*^9}, {3.5455889470855303`*^9, 
   3.5455889734605303`*^9}, 3.573080786546875*^9, 3.573082398609375*^9, 
   3.573083096109375*^9, {3.5730831329375*^9, 3.573083161875*^9}, 
   3.5730863505*^9, 3.573086406671875*^9, 3.573086458078125*^9, 
   3.573090193046875*^9, 3.573090250921875*^9, 3.5731110916875*^9, 
   3.57311160796875*^9, 3.573111656046875*^9, 3.57311335225*^9, 
   3.573113402953125*^9, 3.5732584953212075`*^9, 3.5732585651024575`*^9, 
   3.573258623961833*^9, {3.573611129875*^9, 3.573611137296875*^9}, 
   3.573612729734375*^9, {3.5736127756875*^9, 3.5736128298125*^9}, {
   3.573612875109375*^9, 3.573612925984375*^9}, {3.573777479171875*^9, 
   3.5737775133125*^9}, {3.57378118865625*^9, 3.573781225484375*^9}, {
   3.574253102328125*^9, 3.574253131109375*^9}}]
}, Open  ]],

Cell["\<\
Below we demonstrate minimizing the 35-dimensional hyperellipsoid function \
with the traditional and \[OpenCurlyDoubleQuote]adaptive\
\[CloseCurlyDoubleQuote] Nelder-Mead scaling parameters. The latter can \
sometimes yield a dramatic improvement in performance and/or reliability:\
\>", "Text",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.54464877378125*^9, 3.544648802421875*^9}, {
  3.544648839734375*^9, 3.544648890578125*^9}, {3.54464895653125*^9, 
  3.54464895696875*^9}, {3.573084832015625*^9, 3.57308483709375*^9}, {
  3.573084875859375*^9, 3.57308492890625*^9}, {3.573085237625*^9, 
  3.573085249109375*^9}, {3.573086161828125*^9, 3.573086216015625*^9}, {
  3.57308625853125*^9, 3.573086306078125*^9}},
 FontSize->16],

Cell[BoxData[
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", 
     RowBox[{"Unique", "[", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{"x", ",", "35"}], "]"}], ",", "Temporary"}], "]"}]}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{
  3.573086227296875*^9, 3.573086303953125*^9, {3.57361089928125*^9, 
   3.573610901921875*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Standard", " ", "Nelder"}], "-", 
    RowBox[{"Mead", " ", 
     RowBox[{"parameters", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NelderMeadMinimize", "[", "\[IndentingNewLine]", 
    RowBox[{"NelderMeadMinimize`Dump`Hyperellipsoid", ",", 
     RowBox[{"Evaluate", "[", "vars", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<ReflectRatio\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\"\<ExpandRatio\>\"", "\[Rule]", "2"}], ",", 
     RowBox[{"\"\<ContractRatio\>\"", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"\"\<ShrinkRatio\>\"", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], 
    "\[IndentingNewLine]", "]"}], "//", "Timing"}]}]], "Input",
 CellChangeTimes->{{3.57308369953125*^9, 3.57308370453125*^9}, 
   3.573084326609375*^9, {3.573084412109375*^9, 3.573084467390625*^9}, {
   3.57308462753125*^9, 3.57308464309375*^9}, {3.573084789625*^9, 
   3.573084799296875*^9}, {3.573084871671875*^9, 3.573084872078125*^9}, {
   3.573084984390625*^9, 3.573085041921875*^9}, 3.57308617540625*^9, 
   3.5737761288125*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.609375`6.84076030667078", ",", 
   RowBox[{"{", 
    RowBox[{"1.0210126278829816`", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x$43775", "\[Rule]", "0.9511701299294422`"}], ",", 
       RowBox[{"x$43776", "\[Rule]", "1.3361928517123474`"}], ",", 
       RowBox[{"x$43777", "\[Rule]", "1.1880390916900956`"}], ",", 
       RowBox[{"x$43778", "\[Rule]", "0.8257560969261885`"}], ",", 
       RowBox[{"x$43779", "\[Rule]", "1.018965008273634`"}], ",", 
       RowBox[{"x$43780", "\[Rule]", "0.9430496444362493`"}], ",", 
       RowBox[{"x$43781", "\[Rule]", "1.065953625101244`"}], ",", 
       RowBox[{"x$43782", "\[Rule]", "0.9948697973513471`"}], ",", 
       RowBox[{"x$43783", "\[Rule]", "1.011075592263639`"}], ",", 
       RowBox[{"x$43784", "\[Rule]", "1.049948177865927`"}], ",", 
       RowBox[{"x$43785", "\[Rule]", "0.8693682085655282`"}], ",", 
       RowBox[{"x$43786", "\[Rule]", "1.058748362638638`"}], ",", 
       RowBox[{"x$43787", "\[Rule]", "0.9676088696719103`"}], ",", 
       RowBox[{"x$43788", "\[Rule]", "0.9586678186061989`"}], ",", 
       RowBox[{"x$43789", "\[Rule]", "0.9793962051172472`"}], ",", 
       RowBox[{"x$43790", "\[Rule]", "0.944424205605258`"}], ",", 
       RowBox[{"x$43791", "\[Rule]", "1.0288494044054786`"}], ",", 
       RowBox[{"x$43792", "\[Rule]", "1.034696200912517`"}], ",", 
       RowBox[{"x$43793", "\[Rule]", "1.004371257416905`"}], ",", 
       RowBox[{"x$43794", "\[Rule]", "0.9647465224380722`"}], ",", 
       RowBox[{"x$43795", "\[Rule]", "1.034891699587107`"}], ",", 
       RowBox[{"x$43796", "\[Rule]", "0.9911333724513093`"}], ",", 
       RowBox[{"x$43797", "\[Rule]", "0.9609160790185086`"}], ",", 
       RowBox[{"x$43798", "\[Rule]", "0.9898837236994489`"}], ",", 
       RowBox[{"x$43799", "\[Rule]", "0.9927417518976926`"}], ",", 
       RowBox[{"x$43800", "\[Rule]", "0.9939102455743288`"}], ",", 
       RowBox[{"x$43801", "\[Rule]", "1.002117337259948`"}], ",", 
       RowBox[{"x$43802", "\[Rule]", "0.9832426973137314`"}], ",", 
       RowBox[{"x$43803", "\[Rule]", "0.995904734025649`"}], ",", 
       RowBox[{"x$43804", "\[Rule]", "1.0140790400293387`"}], ",", 
       RowBox[{"x$43805", "\[Rule]", "0.9932234261752186`"}], ",", 
       RowBox[{"x$43806", "\[Rule]", "0.9859943188560265`"}], ",", 
       RowBox[{"x$43807", "\[Rule]", "0.9988133959387141`"}], ",", 
       RowBox[{"x$43808", "\[Rule]", "1.0149177164981447`"}], ",", 
       RowBox[{"x$43809", "\[Rule]", "1.0138177415376304`"}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5730836500625*^9, 3.57308367375*^9}, {
   3.573083711578125*^9, 3.573083719328125*^9}, 3.57308405709375*^9, {
   3.57308413825*^9, 3.5730841539375*^9}, 3.573084187140625*^9, {
   3.573084227234375*^9, 3.57308425875*^9}, {3.573084335953125*^9, 
   3.573084357046875*^9}, 3.573084426109375*^9, 3.57308453878125*^9, 
   3.57308466571875*^9, 3.573084941015625*^9, 3.573084996265625*^9, 
   3.573085031765625*^9, {3.573085067484375*^9, 3.573085142*^9}, {
   3.57308622465625*^9, 3.5730862340625*^9}, 3.57308635909375*^9, 
   3.573086414421875*^9, 3.5730864658125*^9, 3.573090200890625*^9, 
   3.573090258828125*^9, 3.57311109978125*^9, 3.573111615703125*^9, 
   3.57311166384375*^9, 3.573113359984375*^9, 3.573113410765625*^9, 
   3.5732585062274575`*^9, 3.5732585759149575`*^9, 3.5732586346337075`*^9, {
   3.57361093165625*^9, 3.57361094640625*^9}, {3.573611150796875*^9, 
   3.57361116909375*^9}, {3.573612740078125*^9, 3.573612763234375*^9}, {
   3.573777530203125*^9, 3.573777565640625*^9}, {3.573781287375*^9, 
   3.57378129775*^9}, {3.5742531549375*^9, 3.574253164140625*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"\"\<Adaptive\>\"", " ", "Nelder"}], "-", 
    RowBox[{"Mead", " ", 
     RowBox[{"parameters", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dim", ":=", "NelderMeadMinimize`Private`dimension"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"NelderMeadMinimize", "[", "\[IndentingNewLine]", 
      RowBox[{"NelderMeadMinimize`Dump`Hyperellipsoid", ",", 
       RowBox[{"Evaluate", "[", "vars", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<ReflectRatio\>\"", "\[Rule]", "1"}], ",", 
       RowBox[{"\"\<ExpandRatio\>\"", "\[RuleDelayed]", 
        RowBox[{"1", "+", 
         RowBox[{"2", "/", "dim"}]}]}], ",", 
       RowBox[{"\"\<ContractRatio\>\"", "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"3", "/", "4"}], "-", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"2", "dim"}], ")"}]}]}]}], ",", 
       RowBox[{"\"\<ShrinkRatio\>\"", "\[RuleDelayed]", 
        RowBox[{"1", "-", 
         RowBox[{"1", "/", "dim"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}]}], 
      "\[IndentingNewLine]", "]"}], "//", "Timing"}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.57308340346875*^9, 3.5730834784375*^9}, {
   3.573083522234375*^9, 3.5730835245*^9}, 3.573083607421875*^9, {
   3.57308419071875*^9, 3.573084197875*^9}, 3.573084339671875*^9, {
   3.573084431515625*^9, 3.57308443365625*^9}, {3.573084472203125*^9, 
   3.57308447428125*^9}, {3.573084629859375*^9, 3.573084632109375*^9}, {
   3.573084803015625*^9, 3.5730848119375*^9}, {3.5730848676875*^9, 
   3.573084869859375*^9}, {3.57308498709375*^9, 3.57308504409375*^9}, 
   3.573086181734375*^9, {3.573112490734375*^9, 3.57311249203125*^9}, {
   3.573776131921875*^9, 3.57377618315625*^9}, {3.57377703128125*^9, 
   3.5737770368125*^9}, 3.573795300828125*^9, {3.573795343421875*^9, 
   3.573795349796875*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.703125`5.867632453071081", ",", 
   RowBox[{"{", 
    RowBox[{"1.1587244107995808`*^-15", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x$43775", "\[Rule]", "1.0000000059692766`"}], ",", 
       RowBox[{"x$43776", "\[Rule]", "0.9999999967031897`"}], ",", 
       RowBox[{"x$43777", "\[Rule]", "0.9999999922163585`"}], ",", 
       RowBox[{"x$43778", "\[Rule]", "1.0000000001988272`"}], ",", 
       RowBox[{"x$43779", "\[Rule]", "0.9999999956771672`"}], ",", 
       RowBox[{"x$43780", "\[Rule]", "1.0000000007162233`"}], ",", 
       RowBox[{"x$43781", "\[Rule]", "0.9999999977453501`"}], ",", 
       RowBox[{"x$43782", "\[Rule]", "0.9999999982767824`"}], ",", 
       RowBox[{"x$43783", "\[Rule]", "0.9999999975004947`"}], ",", 
       RowBox[{"x$43784", "\[Rule]", "0.999999999673155`"}], ",", 
       RowBox[{"x$43785", "\[Rule]", "1.0000000009853949`"}], ",", 
       RowBox[{"x$43786", "\[Rule]", "1.0000000001867004`"}], ",", 
       RowBox[{"x$43787", "\[Rule]", "0.9999999973070703`"}], ",", 
       RowBox[{"x$43788", "\[Rule]", "1.0000000019689754`"}], ",", 
       RowBox[{"x$43789", "\[Rule]", "0.9999999992535358`"}], ",", 
       RowBox[{"x$43790", "\[Rule]", "1.0000000006545204`"}], ",", 
       RowBox[{"x$43791", "\[Rule]", "0.9999999992651951`"}], ",", 
       RowBox[{"x$43792", "\[Rule]", "0.9999999986250742`"}], ",", 
       RowBox[{"x$43793", "\[Rule]", "0.9999999999585668`"}], ",", 
       RowBox[{"x$43794", "\[Rule]", "1.0000000020577355`"}], ",", 
       RowBox[{"x$43795", "\[Rule]", "1.000000001520709`"}], ",", 
       RowBox[{"x$43796", "\[Rule]", "1.0000000001205007`"}], ",", 
       RowBox[{"x$43797", "\[Rule]", "0.9999999986617961`"}], ",", 
       RowBox[{"x$43798", "\[Rule]", "0.9999999989268863`"}], ",", 
       RowBox[{"x$43799", "\[Rule]", "1.0000000011354782`"}], ",", 
       RowBox[{"x$43800", "\[Rule]", "0.9999999994910571`"}], ",", 
       RowBox[{"x$43801", "\[Rule]", "1.000000000288816`"}], ",", 
       RowBox[{"x$43802", "\[Rule]", "1.0000000019947497`"}], ",", 
       RowBox[{"x$43803", "\[Rule]", "1.000000000496911`"}], ",", 
       RowBox[{"x$43804", "\[Rule]", "0.9999999995632644`"}], ",", 
       RowBox[{"x$43805", "\[Rule]", "0.9999999991096881`"}], ",", 
       RowBox[{"x$43806", "\[Rule]", "0.9999999992310082`"}], ",", 
       RowBox[{"x$43807", "\[Rule]", "0.9999999999249255`"}], ",", 
       RowBox[{"x$43808", "\[Rule]", "0.9999999988792047`"}], ",", 
       RowBox[{"x$43809", "\[Rule]", "0.9999999990159856`"}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.573084147125*^9, 3.573084219671875*^9}, {
   3.57308425046875*^9, 3.573084264171875*^9}, {3.573084348390625*^9, 
   3.573084364796875*^9}, 3.57308443753125*^9, 3.573084559703125*^9, 
   3.5730846710625*^9, 3.573084950015625*^9, {3.573085002265625*^9, 
   3.5730850305*^9}, {3.57308507471875*^9, 3.57308514896875*^9}, 
   3.57308623821875*^9, 3.57308636103125*^9, 3.5730864163125*^9, 
   3.573086467734375*^9, 3.573090202828125*^9, 3.573090260734375*^9, 
   3.57311110175*^9, 3.573111617625*^9, 3.573111665734375*^9, 
   3.573113361890625*^9, 3.573113412671875*^9, 3.573258508430583*^9, 
   3.573258578118083*^9, 3.573258636805583*^9, {3.573610953015625*^9, 
   3.573610959515625*^9}, {3.57361115521875*^9, 3.5736111579375*^9}, {
   3.5736127421875*^9, 3.573612751609375*^9}, {3.57361309478125*^9, 
   3.573613142546875*^9}, {3.5737762135*^9, 3.573776216671875*^9}, {
   3.5737770390625*^9, 3.57377704696875*^9}, {3.57377757003125*^9, 
   3.57377758084375*^9}, {3.573781302703125*^9, 3.573781306890625*^9}, {
   3.57425316915625*^9, 3.574253179125*^9}}]
}, Open  ]]
},
WindowSize->{898, 887},
WindowMargins->{{16, Automatic}, {Automatic, 13}},
ShowSelection->True,
FrontEndVersion->"7.0 for Microsoft Windows (64-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 653, 22, 56, "Text"],
Cell[CellGroupData[{
Cell[1235, 46, 346, 7, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[1584, 55, 3205, 58, 172, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[4792, 115, 1882, 37, 152, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[6677, 154, 740, 15, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[7420, 171, 977, 21, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[8400, 194, 635, 14, 52, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[9038, 210, 233, 5, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[9274, 217, 12119, 216, 692, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[21396, 435, 1952, 33, 132, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[23351, 470, 2540, 52, 112, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[25894, 524, 2586, 56, 132, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[28483, 582, 2392, 52, 132, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[30878, 636, 41517, 759, 2652, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[72398, 1397, 1406, 35, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[73807, 1434, 952, 28, 72, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[74762, 1464, 1749, 45, 78, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[76514, 1511, 212, 5, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[76729, 1518, 214, 5, 31, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[76958, 1526, 337, 8, 42, "Text"],
Cell[77298, 1536, 410, 12, 31, "Input"],
Cell[CellGroupData[{
Cell[77733, 1552, 1794, 41, 192, "Input"],
Cell[79530, 1595, 1575, 28, 66, "Print"],
Cell[81108, 1625, 699, 12, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81844, 1642, 2516, 50, 98, "Input"],
Cell[84363, 1694, 1197, 19, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85597, 1718, 2366, 47, 98, "Input"],
Cell[87966, 1767, 2012, 31, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90015, 1803, 5244, 85, 172, "Input"],
Cell[95262, 1890, 1555, 23, 30, "Output"]
}, Open  ]],
Cell[96832, 1916, 287, 7, 41, "Text"],
Cell[97122, 1925, 482, 13, 31, "Input"],
Cell[CellGroupData[{
Cell[97629, 1942, 1683, 40, 192, "Input"],
Cell[99315, 1984, 1732, 31, 66, "Print"],
Cell[101050, 2017, 692, 13, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101779, 2035, 2501, 49, 112, "Input"],
Cell[104283, 2086, 1111, 18, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105431, 2109, 2347, 47, 112, "Input"],
Cell[107781, 2158, 1402, 22, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109220, 2185, 5300, 86, 172, "Input"],
Cell[114523, 2273, 1546, 24, 30, "Output"]
}, Open  ]],
Cell[116084, 2300, 747, 13, 63, "Text"],
Cell[116834, 2315, 419, 13, 31, "Input"],
Cell[CellGroupData[{
Cell[117278, 2332, 1231, 24, 132, "Input"],
Cell[118512, 2358, 3672, 58, 145, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122221, 2421, 2045, 42, 172, "Input"],
Cell[124269, 2465, 3659, 58, 133, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
